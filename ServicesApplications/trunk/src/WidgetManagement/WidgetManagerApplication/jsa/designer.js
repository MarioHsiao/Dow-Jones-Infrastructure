if(!window.FactivaWidgetRenderManager){FactivaWidgetRenderManager=(function(){var instance=null;function PrivateConstructor(){var _initialized=false;this.getInitialized=function(){return _initialized;};this.setInitialized=function(value){_initialized=value;};var _index=0;this.getIndex=function(){return _index;};this.setIndex=function(value){_index=value;};var _data=null;this.getData=function(){return _data;};this.setData=function(value){_data=value;};var _fontFamilies={0:"Arial, Helvetica, sans-serif",1:"&quot;Comic Sans MS&quot;, cursive",2:"&quot;Courier New&quot;, Courier, monospace",3:"Geneva, &quot;MS Sans Serif&quot;, sans-serif",4:"Georgia, serif",5:"Helvetica, Arial, sans-serif",6:"&quot;Times New Roman&quot;, serif",7:"&quot;Trebuchet MS&quot;, sans-serif",8:"Verdana, Arial, Helvetica, sans-serif"};this.getFontFamilies=function(){return _fontFamilies;};var _fontSizes={0:{"cssValue":"xx-small","titleFontSize":9,"contentFontSize":8},1:{"cssValue":"x-small","titleFontSize":10,"contentFontSize":9},2:{"cssValue":"small","titleFontSize":11,"contentFontSize":10},3:{"cssValue":"medium","titleFontSize":12,"contentFontSize":11},4:{"cssValue":"large","titleFontSize":13,"contentFontSize":12},5:{"cssValue":"x-large","titleFontSize":14,"contentFontSize":13},6:{"cssValue":"xx-large","titleFontSize":15,"contentFontSize":14}};this.getFontSizes=function(){return _fontSizes;};var _colorTemplates={1:{"fontFamily":6,"fontSize":4,"mainColor":"#999999","mainFontColor":"#FFFFFF","accentColor":"#CCCCCC","accentFontColor":"#A24E04","chartBarColor":"#101AE3"},2:{"fontFamily":8,"fontSize":4,"mainColor":"#313B56","mainFontColor":"#F7F7F7","accentColor":"#5D6681","accentFontColor":"#DCDADA","chartBarColor":"#BDD546"},3:{"fontFamily":4,"fontSize":4,"mainColor":"#71AC2B","mainFontColor":"#000000","accentColor":"#9CD756","accentFontColor":"#333333","chartBarColor":"#A2A2A2"},4:{"fontFamily":8,"fontSize":4,"mainColor":"#999999","mainFontColor":"#000000","accentColor":"#CCCCCC","accentFontColor":"#666666","chartBarColor":"#4988C0"},5:{"fontFamily":4,"fontSize":4,"mainColor":"#940403","mainFontColor":"#FFFFFF","accentColor":"#D6D6D6","accentFontColor":"#940403","chartBarColor":"#00BCE9"}};this.getColorTemplates=function(){return _colorTemplates;};var xMac,xSfr3,xOp7Up,xOp6Dn,xIE4Up,xIE4,xIE5,xIE6,xIE7,xNN4,xUA=navigator.userAgent.toLowerCase();this.xIsSafari3=function(){if(xUA.indexOf('safari')>0){var is_minor=parseFloat(xUA.substring(xUA.indexOf('safari')+7,xUA.indexOf('safari')+12));var is_major=parseInt(is_minor);if(is_major>=500){return true;} else{return false;}} return false;};xSfr3=this.xIsSafari3();if(window.opera){var i=xUA.indexOf('opera');if(i!=-1){var v=parseInt(xUA.charAt(i+6));xOp7Up=v>=7;xOp6Dn=v<7;}} else if(navigator.vendor!='KDE'&&document.all&&xUA.indexOf('msie')!=-1){xIE4Up=parseFloat(navigator.appVersion)>=4;xIE4=xUA.indexOf('msie 4')!=-1;xIE5=xUA.indexOf('msie 5')!=-1;xIE6=xUA.indexOf('msie 6')!=-1;xIE7=xUA.indexOf('msie 7')!=-1;} else if(document.layers){xNN4=true;} xMac=xUA.indexOf('mac')!=-1;this.xAddEventListener=function(e,eT,eL,cap){if(!(e=this.xGetElementById(e)))return;eT=eT.toLowerCase();if(e.addEventListener)e.addEventListener(eT,eL,cap||false);else if(e.attachEvent)e.attachEvent('on'+eT,eL);else{var o=e['on'+eT];e['on'+eT]=typeof o=='function'?function(v){o(v);eL(v);}:eL;}};this.xBackground=function(e,c,i){if(!(e=this.xGetElementById(e)))return'';var bg='';if(e.style){if(this.xStr(c)){e.style.backgroundColor=c;} if(this.xStr(i)){e.style.backgroundImage=(i!='')?'url('+i+')':null;} bg=e.style.backgroundColor;} return bg;};this.xClientHeight=function(){var v=0,d=document,w=window;if(d.compatMode=='CSS1Compat'&&!w.opera&&d.documentElement&&d.documentElement.clientHeight){v=d.documentElement.clientHeight;} else if(d.body&&d.body.clientHeight){v=d.body.clientHeight;} else if(this.xDef(w.innerWidth,w.innerHeight,d.width)){v=w.innerHeight;if(d.width>w.innerWidth)v-=16;} return v;};this.xClientWidth=function(){var v=0,d=document,w=window;if(d.compatMode=='CSS1Compat'&&!w.opera&&d.documentElement&&d.documentElement.clientWidth){v=d.documentElement.clientWidth;} else if(d.body&&d.body.clientWidth){v=d.body.clientWidth;} else if(this.xDef(w.innerWidth,w.innerHeight,d.height)){v=w.innerWidth;if(d.height>w.innerHeight)v-=16;} return v;};this.xClip=function(e,t,r,b,l){if(!(e=this.xGetElementById(e)))return;if(e.style){if(xNum(l))e.style.clip='rect('+t+'px '+r+'px '+b+'px '+l+'px)';else e.style.clip='rect(0 '+parseInt(e.style.width)+'px '+parseInt(e.style.height)+'px 0)';}};this.xColor=function(e,s){if(!(e=this.xGetElementById(e)))return'';var c='';if(e.style&&this.xDef(e.style.color)){if(this.xStr(s))e.style.color=s;c=e.style.color;} return c;};this.xCreateElement=function(sTag){if(document.createElement)return document.createElement(sTag);else return null;};this.xDef=function(){for(var i=0;i<arguments.length;++i){if(typeof(arguments[i])=='undefined')return false;} return true;};this.xDisplay=function(e,s){if((e=this.xGetElementById(e))&&e.style&&this.xDef(e.style.display)){if(this.xStr(s)){try{e.style.display=s;} catch(ex){e.style.display='';}} return e.style.display;} return null;};this.xGetComputedStyle=function(oEle,sProp,bInt){var s,p='undefined';var dv=document.defaultView;if(dv&&dv.getComputedStyle){s=dv.getComputedStyle(oEle,'');if(s)p=s.getPropertyValue(sProp);} else if(oEle.currentStyle){var i,c,a=sProp.split('-');sProp=a[0];for(i=1;i<a.length;++i){c=a[i].charAt(0);sProp+=a[i].replace(c,c.toUpperCase());} p=oEle.currentStyle[sProp];} else return null;return bInt?(parseInt(p)||0):p;};this.xGetElementById=function(e){if(typeof(e)=='string'){if(document.getElementById)e=document.getElementById(e);else if(document.all)e=document.all[e];else e=null;} return e;};this.xGetElementsByTagName=function(t,p){var list=null;t=t||'*';p=p||document;if(p.getElementsByTagName){list=p.getElementsByTagName(t);if(t=='*'&&(!list||!list.length))list=p.all;} else{if(t=='*')list=p.all;else if(p.all&&p.all.tags)list=p.all.tags(t);} return list||[];};this.xHasPoint=function(e,x,y,t,r,b,l){if(!this.xNum(t)){t=r=b=l=0;} else if(!this.xNum(r)){r=b=l=t;} else if(!this.xNum(b)){l=r;b=t;} var eX=this.xPageX(e),eY=this.xPageY(e);return(x>=eX+l&&x<=eX+this.xWidth(e)-r&&y>=eY+t&&y<=eY+this.xHeight(e)-b);};this.xHeight=function(e,h){if(!(e=this.xGetElementById(e)))return 0;if(this.xNum(h)){if(h<0)h=0;else h=Math.round(h);} else h=-1;var css=this.xDef(e.style);if(e==document||e.tagName.toLowerCase()=='html'||e.tagName.toLowerCase()=='body'){h=this.xClientHeight();} else if(css&&this.xDef(e.offsetHeight)&&this.xStr(e.style.height)){if(h>=0){var pt=0,pb=0,bt=0,bb=0;if(document.compatMode=='CSS1Compat'){var gcs=this.xGetComputedStyle;pt=gcs(e,'padding-top',1);if(pt!==null){pb=gcs(e,'padding-bottom',1);bt=gcs(e,'border-top-width',1);bb=gcs(e,'border-bottom-width',1);} else if(this.xDef(e.offsetHeight,e.style.height)){e.style.height=h+'px';pt=e.offsetHeight-h;}} h-=(pt+pb+bt+bb);if(isNaN(h)||h<0)return;else e.style.height=h+'px';} h=e.offsetHeight;} else if(css&&this.xDef(e.style.pixelHeight)){if(h>=0)e.style.pixelHeight=h;h=e.style.pixelHeight;} return h;};this.xHide=function(e){return this.xVisibility(e,0);};this.xLeft=function(e,iX){if(!(e=this.xGetElementById(e)))return 0;var css=this.xDef(e.style);if(css&&this.xStr(e.style.left)){if(this.xNum(iX))e.style.left=iX+'px';else{iX=parseInt(e.style.left);if(isNaN(iX))iX=this.xGetComputedStyle(e,'left',1);if(isNaN(iX))iX=0;}} else if(css&&this.xDef(e.style.pixelLeft)){if(this.xNum(iX))e.style.pixelLeft=iX;else iX=e.style.pixelLeft;} return iX;};this.xMoveTo=function(e,x,y){this.xLeft(e,x);this.xTop(e,y);};this.xNum=function(){for(var i=0;i<arguments.length;++i){if(isNaN(arguments[i])||typeof(arguments[i])!='number')return false;} return true;};this.xOffsetLeft=function(e){if(!(e=this.xGetElementById(e)))return 0;if(this.xDef(e.offsetLeft))return e.offsetLeft;else return 0;};this.xOffsetTop=function(e){if(!(e=this.xGetElementById(e)))return 0;if(xDef(e.offsetTop))return e.offsetTop;else return 0;};this.xOpacity=function(e,o){var set=this.xDef(o);if(!(e=this.xGetElementById(e)))return 2;if(this.xStr(e.style.opacity)){if(set)e.style.opacity=o+'';else o=parseFloat(e.style.opacity);} else if(this.xStr(e.style.filter)){if(set)e.style.filter='alpha(opacity='+(100*o)+')';else if(e.filters&&e.filters.alpha){o=e.filters.alpha.opacity/100;}} else if(this.xStr(e.style.MozOpacity)){if(set)e.style.MozOpacity=o+'';else o=parseFloat(e.style.MozOpacity);} else if(this.xStr(e.style.KhtmlOpacity)){if(set)e.style.KhtmlOpacity=o+'';else o=parseFloat(e.style.KhtmlOpacity);} return isNaN(o)?1:o;};this.xPageX=function(e){if(!(e=this.xGetElementById(e)))return 0;var x=0;while(e){if(this.xDef(e.offsetLeft))x+=e.offsetLeft;e=this.xDef(e.offsetParent)?e.offsetParent:null;} return x;};this.xPageY=function(e){if(!(e=this.xGetElementById(e)))return 0;var y=0;while(e){if(this.xDef(e.offsetTop))y+=e.offsetTop;e=this.xDef(e.offsetParent)?e.offsetParent:null;} return y;};this.xParent=function(e,bNode){if(!(e=this.xGetElementById(e)))return null;var p=null;if(!bNode&&this.xDef(e.offsetParent))p=e.offsetParent;else if(this.xDef(e.parentNode))p=e.parentNode;else if(this.xDef(e.parentElement))p=e.parentElement;return p;};this.xParentNode=function(ele,n){while(ele&&n--){ele=ele.parentNode;} return ele;};this.xRemoveEventListener=function(e,eT,eL,cap){if(!(e=this.xGetElementById(e)))return;eT=eT.toLowerCase();if(e.removeEventListener)e.removeEventListener(eT,eL,cap||false);else if(e.detachEvent)e.detachEvent('on'+eT,eL);else e['on'+eT]=null;};this.xResizeTo=function(e,w,h){this.xWidth(e,w);this.xHeight(e,h);};this.xScrollLeft=function(e,bWin){var offset=0;if(!this.xDef(e)||bWin||e==document||e.tagName.toLowerCase()=='html'||e.tagName.toLowerCase()=='body'){var w=window;if(bWin&&e)w=e;if(w.document.documentElement&&w.document.documentElement.scrollLeft)offset=w.document.documentElement.scrollLeft;else if(w.document.body&&this.xDef(w.document.body.scrollLeft))offset=w.document.body.scrollLeft;} else{e=this.xGetElementById(e);if(e&&this.xNum(e.scrollLeft))offset=e.scrollLeft;} return offset;};this.xScrollTop=function(e,bWin){var offset=0;if(!this.xDef(e)||bWin||e==document||e.tagName.toLowerCase()=='html'||e.tagName.toLowerCase()=='body'){var w=window;if(bWin&&e)w=e;if(w.document.documentElement&&w.document.documentElement.scrollTop)offset=w.document.documentElement.scrollTop;else if(w.document.body&&this.xDef(w.document.body.scrollTop))offset=w.document.body.scrollTop;} else{e=this.xGetElementById(e);if(e&&this.xNum(e.scrollTop))offset=e.scrollTop;} return offset;};this.xShow=function(e){return this.xVisibility(e,1);};this.xStr=function(s){for(var i=0;i<arguments.length;++i){if(typeof(arguments[i])!='string')return false;} return true;};this.xTabPanelGroup=function(id,w,h,th,clsTP,clsTG,clsTD,clsTS,index){function onClick(){paint(this);return false;} function onFocus(){paint(this);return false;} function paint(tab){tab.className=clsTS;tab.style.zIndex=highZ++;panels[tab.xTabIndex].style.display='block';if(selectedIndex!=tab.xTabIndex){panels[selectedIndex].style.display='none';tabs[selectedIndex].className=clsTD;selectedIndex=tab.xTabIndex;emg_selectedTab=selectedIndex+1;} if(typeof(_IG_AdjustIFrameHeight)!="undefined"&&typeof(_IG_AdjustIFrameHeight)=="function"){window.setTimeout("_IG_AdjustIFrameHeight()",1);}} var panelGrp,tabGrp,panels,tabs,highZ,selectedIndex;this.select=function(n){if(n&&n<=tabs.length){var t=tabs[n-1];t.onclick();}};this.addedListener=false;this.onResize=function(newW,newH){var x=0,i;tabGrp[0].leftCarIndex=(tabGrp[0].leftCarIndex>0)?tabGrp[0].leftCarIndex:0;if(newW){w=newW;this.xWidth(panelGrp,w);} else w=this.xWidth(panelGrp);if(newH){h=newH;this.xHeight(panelGrp,h);} else h=this.xHeight(panelGrp);this.xResizeTo(tabGrp[0],w,th+2);var tw=Math.floor((w-tabs.length*2)/tabs.length);var tabSizeArray=[];for(i=0;i<tabs.length;i++){this.xWidth(tabs[i],"auto");if(tw<=this.xWidth(tabs[i])){tabSizeArray.push(this.xWidth(tabs[i]));this.xResizeTo(tabs[i],this.xWidth(tabs[i]),th);} else{tabSizeArray.push(tw);this.xResizeTo(tabs[i],tw,th);} tabs[i].xTabIndex=i;tabs[i].onclick=onClick;panels[i].style.display='none';} for(var u=0,sum=0;u<tabSizeArray.length;sum+=tabSizeArray[u++]);this.xResizeTo(tabGrp[0],sum,th+2);var leftTab=this.xGetElementById("fctv_tabLeft"+index);var rightTab=this.xGetElementById("fctv_tabRight"+index);this.xHeight(leftTab,th);this.xHeight(rightTab,th);var outerTabContainer=this.xGetElementById("fctv_tabgroup_outer"+index);if(sum>w){if(leftTab!=null){leftTab.style.display="block";if(xIE6)leftTab.style.display="inline";leftTab.style.visibility="visible";leftTab.className="tabLeft";this.xWidth(leftTab,22);} if(rightTab!=null){rightTab.style.display="block";if(xIE6)rightTab.style.display="inline";rightTab.style.visibility="visible";rightTab.className="tabRight";this.xWidth(rightTab,22);} if(outerTabContainer!=null){outerTabContainer.style.width="100%";outerTabContainer.style.marginLeft="22px";outerTabContainer.style.marginRight="22px";if(xIE6){outerTabContainer.style.display="inline";}} this.xResizeTo(outerTabContainer,outerTabContainer.clientWidth-44,th+2);} else{var gutterWidth=(this.xWidth(outerTabContainer)-sum)/2;if(leftTab!=null){leftTab.style.display="inline-block";leftTab.style.visibility="visible";leftTab.className="tabLeftGutter";this.xWidth(leftTab,gutterWidth);} if(rightTab!=null){rightTab.style.display="inline-block";rightTab.style.visibility="visible";rightTab.className="tabRightGutter";this.xWidth(rightTab,gutterWidth);} if(outerTabContainer!=null){outerTabContainer.style.width="100%";outerTabContainer.style.marginLeft="0px";outerTabContainer.style.marginRight="0px";} tabGrp[0].style.left="0";} highZ=i;tabs[selectedIndex].onclick();};this.xTabPanelGroup.instances[id]=this;panelGrp=this.xGetElementById(id);if(!panelGrp){return null;} panels=this.xGetElementsByClassName(clsTP,panelGrp);tabs=this.xGetElementsByClassName(clsTD,panelGrp);tabGrp=this.xGetElementsByClassName(clsTG,panelGrp);if(!panels||!tabs||!tabGrp||panels.length!=tabs.length||tabGrp.length!=1){return null;} selectedIndex=0;if(!FactivaWidgetRenderManager.getInstance().xTabPanelGroup.instances[id].addedListener){this.xAddEventListener(window,'resize',function(){if(!xIE4Up&&!FactivaWidgetRenderManager.getInstance().xTabPanelGroup.instances[id].addedListener)updateAlertHeadlineWidgetPreview();for(var j=0;j<tabs.length;j++){tabs[j].style.width="auto";} var cDiv=this.xGetElementById("fctv_tabgroup_outer"+index);var leftBtn=this.xGetElementById("fctv_tabLeft"+index);var rightBtn=this.xGetElementById("fctv_tabRight"+index);var cDivRight=this.xLeft(cDiv)+this.xWidth(cDiv);var tDivRight=this.xLeft(tabGrp[0])+this.xWidth(tabGrp[0]);if(tDivRight<cDivRight){this.xLeft(tabGrp[0],tabGrp[0].offsetLeft+(cDivRight-tDivRight));for(var k=0;k<tabs.length;k++){if((tabGrp[0].offsetLeft+tabs[k].offsetLeft)<this.xWidth(leftBtn)){var newK=(k==0)?0:k-1;tabGrp[0].leftCarIndex=newK;tabGrp[0].edgeDistance=this.xWidth(tabs[newK])-(tabGrp[0].offsetLeft+tabs[k].offsetLeft);rightBtn.style.backgroundColor="#DDDDDD";}}} if(this.xWidth(cDiv)>this.xWidth(tabGrp[0])){tabGrp[0].leftCarIndex=0;tabGrp[0].edgeDistance=null;rightBtn.onclick=function(){FactivaWidgetRenderManager.getInstance().moveLeftTab(index);return false;};rightBtn.style.backgroundColor="#FFFFFF";leftBtn.style.backgroundColor="#FFFFFF";} else{if(leftBtn){leftBtn.style.backgroundColor="#FFFFFF";if(tabGrp[0].edgeDistance==null){if(tabGrp[0].leftCarIndex<=0){leftBtn.style.backgroundColor="#DDDDDD";}}}} if(rightBtn&&rightBtn.onclick!=null&&leftBtn.style.backgroundColor=="#FFFFFF"){rightBtn.style.backgroundColor="#FFFFFF";leftBtn.style.backgroundColor="#DDDDDD";} FactivaWidgetRenderManager.getInstance().xTabPanelGroup.instances[id].onResize(0,0);FactivaWidgetRenderManager.getInstance().xTabPanelGroup.instances[id].addedListener=true;},false);} this.onResize(w,h);this.xAddEventListener(window,'unload',function winUnload(){for(var i=0;i<tabs.length;++i){tabs[i].onfocus=tabs[i].onclick=tabs[i].xTabIndex=null;panels[i]=null;} highZ=null;tabGrp=null;panelGrp=null;selectedIndex=null;FactivaWidgetRenderManager.getInstance().xTabPanelGroup.instances[id]=null;},false);};this.xTabPanelGroup.instances=[];this.xTop=function(e,iY){if(!(e=this.xGetElementById(e)))return 0;var css=this.xDef(e.style);if(css&&this.xStr(e.style.top)){if(this.xNum(iY))e.style.top=iY+'px';else{iY=parseInt(e.style.top);if(isNaN(iY))iY=this.xGetComputedStyle(e,'top',1);if(isNaN(iY))iY=0;}} else if(css&&this.xDef(e.style.pixelTop)){if(this.xNum(iY))e.style.pixelTop=iY;else iY=e.style.pixelTop;} return iY;};this.xVisibility=function(e,bShow){if(!(e=this.xGetElementById(e)))return null;if(e.style&&this.xDef(e.style.visibility)){if(this.xDef(bShow))e.style.visibility=bShow?'visible':'hidden';return e.style.visibility;} return null;};this.xWidth=function(e,w){if(!(e=this.xGetElementById(e)))return 0;if(this.xNum(w)){if(w<0)w=0;else w=Math.round(w);} else w=-1;var css=this.xDef(e.style);if(e==document||e.tagName.toLowerCase()=='html'||e.tagName.toLowerCase()=='body'){w=this.xClientWidth();} else if(css&&this.xDef(e.offsetWidth)&&this.xStr(e.style.width)){if(w>=0){var pl=0,pr=0,bl=0,br=0;if(document.compatMode=='CSS1Compat'){var gcs=this.xGetComputedStyle;pl=gcs(e,'padding-left',1);if(pl!==null){pr=gcs(e,'padding-right',1);bl=gcs(e,'border-left-width',1);br=gcs(e,'border-right-width',1);} else if(this.xDef(e.offsetWidth,e.style.width)){e.style.width=w+'px';pl=e.offsetWidth-w;}} w-=(pl+pr+bl+br);if(isNaN(w)||w<0)return;else e.style.width=w+'px';} w=e.offsetWidth;} else if(css&&this.xDef(e.style.pixelWidth)){if(w>=0)e.style.pixelWidth=w;w=e.style.pixelWidth;} return w;};this.xZIndex=function(e,uZ){if(!(e=this.xGetElementById(e)))return 0;if(e.style&&this.xDef(e.style.zIndex)){if(this.xNum(uZ))e.style.zIndex=uZ;uZ=parseInt(e.style.zIndex);} return uZ;};this.xGetElementsByClassName=function(c,p,t,f){var found=[];var re=new RegExp('\\b'+c+'\\b','i');var list=this.xGetElementsByTagName(t,p);for(var i=0;i<list.length;++i){if(list[i].className&&list[i].className.search(re)!=-1){found[found.length]=list[i];if(f)f(list[i]);}} return found;};this.xGetElementsByTagName=function(t,p){var list=null;t=t||'*';p=p||document;if(p.getElementsByTagName){list=p.getElementsByTagName(t);if(t=='*'&&(!list||!list.length))list=p.all;} else{if(t=='*')list=p.all;else if(p.all&&p.all.tags)list=p.all.tags(t);} return list||[];};this.xInnerHtml=function(e,h){if(!(e=this.xGetElementById(e))||!this.xStr(e.innerHTML))return null;var s=e.innerHTML;if(this.xStr(h)){e.innerHTML=h;} return s;};this.xNextSib=function(e,t){if(!(e=this.xGetElementById(e)))return;var s=e?e.nextSibling:null;if(t)while(s&&s.nodeName.toLowerCase()!=t.toLowerCase()){s=s.nextSibling;} else while(s&&s.nodeType!=1){s=s.nextSibling;} return s;};this.xParentNode=function(ele,n){while(ele&&n--){ele=ele.parentNode;} return ele;};this.xPrevSib=function(e,t){if(!(e=this.xGetElementById(e)))return;var s=e?e.previousSibling:null;if(t)while(s&&s.nodeName.toLowerCase()!=t.toLowerCase()){s=s.previousSibling;} else while(s&&s.nodeType!=1){s=s.previousSibling;} return s;};this.xWalkEleTree=function(n,f,d,l,b){if(typeof l=='undefined')l=0;if(typeof b=='undefined')b=0;var v=f(n,l,b,d);if(!v)return 0;if(v==1){for(var c=n.firstChild;c;c=c.nextSibling){if(c.nodeType==1){if(!l)++b;if(!this.xWalkEleTree(c,f,d,l+1,b))return 0;}}} return 1;};this.xWalkTree=function(n,f){f(n);for(var c=n.firstChild;c;c=c.nextSibling){if(c.nodeType==1)this.xWalkTree(c,f);}};this.xGetElementsByName=function(name,parentEle,tagName,fn){var found=[];var re=new RegExp('\\b'+name+'\\b','i');var list=this.xGetElementsByTagName(tagName,parentEle);for(var i=0;i<list.length;++i){if(list[i].name.search(re)!=-1){found[found.length]=list[i];if(fn)fn(list[i]);}} return found;};this.xRemoveChild=function(oParent,oChild){if(oParent.removeChild)return oParent.removeChild(oChild);else return null;};this.xInsertBefore=function(oParent,oNode,oChild){if(oParent.insertBefore)return oParent.insertBefore(oNode,oChild);};this.xCloneNode=function(oNode){if(oNode.cloneNode)return oNode.cloneNode(true);else return null;};this.xCloneLightNode=function(oNode){if(oNode.cloneNode)return oNode.cloneNode(false);else return null;};this.xRemoveChildren=function(oNode){if(typeof(oNode)!='undefined'&&oNode!=null){return;} var len=oNode.childNodes.length;while(oNode.hasChildNodes()){this.xRemoveChild(oNode,oNode.firstChild);}};this.xParentElement=function(node,tagName,className){for(;node!=null;node=node.parentNode){if(className&&className.length>0){if(node.nodeType==1&&node.nodeName.toUpperCase()==tagName.toUpperCase()&&(node.className==className||node.id==className))return node;} else if(node.nodeType==1&&node.nodeName.toUpperCase()==tagName.toUpperCase())return node;} return null;};this.xFindChildNode=function(nodeObj,tn,cn){cn=(cn)?CStr(cn):"";for(var i=0;i<nodeObj.childNodes.length;i++){switch(nodeObj.childNodes[i].nodeType){case 1:tVal=null;if(nodeObj.childNodes[i].tagName==tn.toUpperCase()&&(nodeObj.childNodes[i].className==cn||nodeObj.childNodes[i].id==cn)){return nodeObj.childNodes[i];} else{tVal=findChildNode(nodeObj.childNodes[i],tn,cn);if(tVal)return tVal;} break;}}};this.xInnerText=function(oNode){if(oNode.innerText)return oNode.innerText;var str="";for(var i=0;i<oNode.childNodes.length;i++){switch(oNode.childNodes.item(i).nodeType){case 1:str+=xInnerText(oNode.childNodes[i]);break;case 3:str+=oNode.childNodes[i].nodeValue;break;}} return str;};var xChildWindow=[];this.xWinOpen=function(sUrl,w,h,winName){var winWidth=800;var winHeight=600;if(w&&w!=null)winWidth=w;if(h&&h!=null)winHeight=h;if(!winName){winName="_factivaWidgetArticleWindow";} var features="left=0,top=0,width="+winWidth+",height="+winHeight+",location=0,menubar=1,resizable=1,scrollbars=1,status=1,toolbar=0";if(xChildWindow[winName]&&!xChildWindow[winName].closed){xChildWindow[winName].location.href=sUrl;try{xChildWindow[winName].resizeTo(winWidth,winHeight);} catch(e){}} else{xChildWindow[winName]=window.open(sUrl,winName,features);try{xChildWindow[winName].resizeTo(winWidth,winHeight);} catch(e){}} try{xChildWindow[winName].focus();} catch(e){} return false;};if(typeof com=="undefined")var com=new Object();if(typeof com.deconcept=="undefined")com.deconcept=new Object();if(typeof com.deconcept.util=="undefined")com.deconcept.util=new Object();if(typeof com.deconcept.FlashObjectUtil=="undefined")com.deconcept.FlashObjectUtil=new Object();com.deconcept.FlashObject=function(swf,id,w,h,ver,c,useExpressInstall,quality,xiRedirectUrl,redirectUrl,detectKey){if(!document.createElement||!document.getElementById)return;this.DETECT_KEY=detectKey?detectKey:'detectflash';this.skipDetect=com.deconcept.util.getRequestParameter(this.DETECT_KEY);this.params=new Object();this.variables=new Object();this.attributes=[];this.useExpressInstall=useExpressInstall;if(swf)this.setAttribute('swf',swf);if(id)this.setAttribute('id',id);if(w)this.setAttribute('width',w);if(h)this.setAttribute('height',h);if(ver)this.setAttribute('version',new com.deconcept.PlayerVersion(ver.toString().split(".")));this.installedVer=com.deconcept.FlashObjectUtil.getPlayerVersion(this.getAttribute('version'),useExpressInstall);if(c)this.addParam('bgcolor',c);var q=quality?quality:'high';this.addParam('quality',q);this.addParam('allowScriptAccess',"always");this.addParam('wmode','transparent');var xir=(xiRedirectUrl)?xiRedirectUrl:window.location;this.setAttribute('xiRedirectUrl',xir);this.setAttribute('redirectUrl','');if(redirectUrl)this.setAttribute('redirectUrl',redirectUrl);};com.deconcept.FlashObject.prototype={setAttribute:function(name,value){this.attributes[name]=value;},getAttribute:function(name){return this.attributes[name];},addParam:function(name,value){this.params[name]=value;},getParams:function(){return this.params;},addVariable:function(name,value){this.variables[name]=value;},getVariable:function(name){return this.variables[name];},getVariables:function(){return this.variables;},createParamTag:function(n,v){var p=document.createElement('param');p.setAttribute('name',n);p.setAttribute('value',v);return p;},getVariablePairs:function(){var variablePairs=[];var key;var variables=this.getVariables();for(key in variables){if(key!="extend")variablePairs.push(key+"="+variables[key]);} return variablePairs;},getFlashHTML:function(){var flashNode="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){if(this.getAttribute("doExpressInstall"))this.addVariable("MMplayerType","PlugIn");flashNode='<embed type="application/x-shockwave-flash" src="'+this.getAttribute('swf')+'" width="'+this.getAttribute('width')+'" height="'+this.getAttribute('height')+'"';flashNode+=' id="'+this.getAttribute('id')+'" name="'+this.getAttribute('id')+'" ';var params=this.getParams();for(var key in params){if(key!="extend")flashNode+=[key]+'="'+params[key]+'" ';} var pairs=this.getVariablePairs().join("&");if(pairs.length>0){flashNode+='flashvars="'+pairs+'"';} flashNode+='/>';} else{if(this.getAttribute("doExpressInstall"))this.addVariable("MMplayerType","ActiveX");flashNode='<object id="'+this.getAttribute('id')+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+this.getAttribute('width')+'" height="'+this.getAttribute('height')+'">';flashNode+='<param name="movie" value="'+this.getAttribute('swf')+'" />';var params=this.getParams();for(var key in params){if(key!="extend")flashNode+='<param name="'+key+'" value="'+params[key]+'" />';} var pairs=this.getVariablePairs().join("&");if(pairs.length>0){flashNode+='<param name="flashvars" value="'+pairs+'" />';} flashNode+="</object>";} return flashNode;},write:function(elementId){if(this.useExpressInstall){var expressInstallReqVer=new com.deconcept.PlayerVersion([6,0,65]);if(this.installedVer.versionIsValid(expressInstallReqVer)&&!this.installedVer.versionIsValid(this.getAttribute('version'))){this.setAttribute('doExpressInstall',true);this.addVariable("MMredirectURL",escape(this.getAttribute('xiRedirectUrl')));document.title=document.title.slice(0,47)+" - Flash Player Installation";this.addVariable("MMdoctitle",document.title);}} else{this.setAttribute('doExpressInstall',false);} if(this.skipDetect||this.getAttribute('doExpressInstall')||this.installedVer.versionIsValid(this.getAttribute('version'))){var n=(typeof elementId=='string')?document.getElementById(elementId):elementId;n.innerHTML=this.getFlashHTML();} else{if(this.getAttribute('redirectUrl')!=""){document.location.replace(this.getAttribute('redirectUrl'));}}}};com.deconcept.FlashObjectUtil.getPlayerVersion=function(reqVer,xiInstall){var PlayerVersion=new com.deconcept.PlayerVersion(0,0,0);if(navigator.plugins&&navigator.mimeTypes.length){var x=navigator.plugins["Shockwave Flash"];if(x&&x.description){PlayerVersion=new com.deconcept.PlayerVersion(x.description.replace(/([a-z]|[A-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."));}} else{try{var axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");for(var i=3;axo!=null;i++){axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+i);PlayerVersion=new com.deconcept.PlayerVersion([i,0,0]);}} catch(e){} if(reqVer&&PlayerVersion.major>reqVer.major)return PlayerVersion;if(!reqVer||((reqVer.minor!=0||reqVer.rev!=0)&&PlayerVersion.major==reqVer.major)||PlayerVersion.major!=6||xiInstall){try{PlayerVersion=new com.deconcept.PlayerVersion(axo.GetVariable("$version").split(" ")[1].split(","));} catch(e){}}} return PlayerVersion;};com.deconcept.PlayerVersion=function(arrVersion){this.major=parseInt(arrVersion[0])||0;this.minor=parseInt(arrVersion[1])||0;this.rev=parseInt(arrVersion[2])||0;};com.deconcept.PlayerVersion.prototype.versionIsValid=function(fv){if(this.major<fv.major)return false;if(this.major>fv.major)return true;if(this.minor<fv.minor)return false;if(this.minor>fv.minor)return true;if(this.rev<fv.rev)return false;return true;};com.deconcept.util={getRequestParameter:function(param){var q=document.location.search||document.location.hash;if(q){var startIndex=q.indexOf(param+"=");var endIndex=(q.indexOf("&",startIndex)>-1)?q.indexOf("&",startIndex):q.length;if(q.length>1&&startIndex>-1){return q.substring(q.indexOf("=",startIndex)+1,endIndex);}} return"";}};if(Array.prototype.push==null){Array.prototype.push=function(item){this[this.length]=item;return this.length;}};var getQueryParamValue=com.deconcept.util.getRequestParameter;var FlashObject=com.deconcept.FlashObject;this.xBuildManualNewsletterWorkspaceWidget=function(tEle,result,showTitle,integrateFontCSS){var startTime=new Date();var serverTime;var metaRandomnumber=Math.floor(Math.random()*100001);if(result!=null&&result.Definition!=null){var sb=[];serverTime=result.ElapsedTime;var mColor=result.Definition.MainColor;var mFontColor=result.Definition.MainFontColor;var aColor=result.Definition.AccentColor;var aFontColor=result.Definition.AccentFontColor;var contentColor=result.Definition.ContentFontColor;var snippetColor=result.Definition.SnippetFontColor;var auxInfoColor=result.Definition.AuxInfoFontColor;var bgColor=result.Definition.BackgroundColor;var widgetName=result.Definition.Name;var numHeadlines=result.Definition.NumItemsPerSection;var fontFamily=(typeof(integrateFontCSS)==='boolean')?"inherit":_fontFamilies[result.Definition.FontFamily];var contentFontSize=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"inherit":_fontSizes[result.Definition.FontSize].contentFontSize+"px";var titleFontSize=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"larger":_fontSizes[result.Definition.FontSize].titleFontSize+"px";var showSnippet=(result.Definition.DisplayType==1);sb[sb.length]="<div id=\"scriptPreview\"  style=\""+this.getOuterContainerStyle(bgColor,fontFamily,contentFontSize,mColor,contentColor)+"\">";if(showTitle){sb[sb.length]=this.getWidgetTitle(widgetName,mColor,titleFontSize,mFontColor,fontFamily,(result.Literals)?result.Literals.Icon:null);sb[sb.length]="<div id=\"fctv_border\"  style=\""+this.getBorderStyle(bgColor,fontFamily,contentFontSize,mColor,contentColor)+"\">";} if(result.ReturnCode!=0&&tEle){this.xInnerHtml(tEle,result.ReturnCode+": "+result.StatusMessage);return;} if(result.Data!=null&&result.Data.ManualNewsletterWorkspaceInfo!=null){if(result.Data.ManualNewsletterWorkspaceInfo.Count>0){for(var i=0;i<result.Data.ManualNewsletterWorkspaceInfo.Count;i++){sb[sb.length]=this.getSectionTitle(result.Data.ManualNewsletterWorkspaceInfo.Sections[i],aColor,titleFontSize,aFontColor,fontFamily);var randomnumber=Math.floor(Math.random()*100001);var _count=result.Data.ManualNewsletterWorkspaceInfo.Sections[i].Headlines.length;var _headlines=result.Data.ManualNewsletterWorkspaceInfo.Sections[i].Headlines;var _curDivCntrId="manualNewsletterWorkspace_"+randomnumber;sb[sb.length]="<div id=\""+_curDivCntrId+"\" class=\"fctv_MnlWrkSpcHeadlineCont\" style=\""+this.getInnerContainerStyle(bgColor,fontFamily,contentFontSize,contentColor)+"\">";if(_count>numHeadlines){sb[sb.length]=this.getPagingBar(numHeadlines,_count,result.Literals,"#e5e5e0",contentFontSize,"#333333",fontFamily,_curDivCntrId);} for(var j=0;j<_count;j++){var showHeadline=(j<numHeadlines);var _headline=_headlines[j];sb[sb.length]=this.getHeadline(bgColor,fontFamily,contentFontSize,contentColor,auxInfoColor,snippetColor,_headline,showHeadline,showSnippet,result.Literals);} if(_count>numHeadlines&&numHeadlines>1){sb[sb.length]=this.getPagingBar(numHeadlines,_count,result.Literals,"#e5e5e0",contentFontSize,"#333333",fontFamily,_curDivCntrId);} sb[sb.length]="</div>";}} else if(result.Literals!=null&&result.Literals.NoResults!=null){sb[sb.length]=this.getNoResultsPanel(bgColor,fontFamily,contentFontSize,contentColor,result.Literals.NoResults);}} if(showTitle){sb[sb.length]="</div>";} if(result.Literals!=null&&result.Literals.CopyRight!=null){sb[sb.length]=this.getCopyRightPanel(metaRandomnumber,mColor,_fontFamilies[0],_fontSizes[1].contentFontSize+"px",contentColor,result.Literals.CopyRight,result.Literals.BrandingBadge,result.Literals.MarketingSiteUrl,result.Literals.MarketingSiteTitle,showTitle);} sb[sb.length]="</div>";this.xInnerHtml(tEle,sb.join(""));} else{this.xInnerHtml(tEle,"Service is unavailable.");} if(typeof(_IG_AdjustIFrameHeight)!="undefined"&&typeof(_IG_AdjustIFrameHeight)=="function"){window.setTimeout("_IG_AdjustIFrameHeight()",1);} var endTime=new Date();this.debugMsg("metaRandomnumber: "+metaRandomnumber+" Rendering Time: "+(endTime.getTime()-startTime.getTime())+"ms; ServerTime: "+serverTime+"ms");this.xInnerHtml(metaRandomnumber+"","{r:"+(endTime.getTime()-startTime.getTime())+";s:"+serverTime+"}");};this.xBuildAutomaticWorkspaceWidget=function(tEle,result,showTitle,integrateFontCSS){var startTime=new Date();var serverTime;var metaRandomnumber=Math.floor(Math.random()*100001);if(result!=null&&result.Definition!=null){var sb=[];serverTime=result.ElapsedTime;var mColor=result.Definition.MainColor;var mFontColor=result.Definition.MainFontColor;var aColor=result.Definition.AccentColor;var aFontColor=result.Definition.AccentFontColor;var contentColor=result.Definition.ContentFontColor;var snippetColor=result.Definition.SnippetFontColor;var auxInfoColor=result.Definition.AuxInfoFontColor;var bgColor=result.Definition.BackgroundColor;var widgetName=result.Definition.Name;var numHeadlines=result.Definition.NumOfHeadlines;var fontFamily=(typeof(integrateFontCSS)==='boolean')?"inherit":_fontFamilies[result.Definition.FontFamily];var contentFontSize=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"inherit":_fontSizes[result.Definition.FontSize].contentFontSize+"px";var titleFontSize=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"larger":_fontSizes[result.Definition.FontSize].titleFontSize+"px";var showSnippet=(result.Definition.DisplayType==1);sb[sb.length]="<div id=\"scriptPreview\"  style=\""+this.getOuterContainerStyle(bgColor,fontFamily,contentFontSize,mColor,contentColor)+"\">";if(showTitle){sb[sb.length]=this.getWidgetTitle(widgetName,mColor,titleFontSize,mFontColor,fontFamily,(result.Literals)?result.Literals.Icon:null);sb[sb.length]="<div id=\"fctv_border\"  style=\""+this.getBorderStyle(bgColor,fontFamily,contentFontSize,mColor,contentColor)+"\">";} if(result.ReturnCode!=0&&tEle){this.xInnerHtml(tEle,result.ReturnCode+": "+result.StatusMessage);return;} if(result.Data!=null&&result.Data.AutomaticWorkspaceInfo!=null){if(result.Data.AutomaticWorkspaceInfo.Count>0){var randomnumber=Math.floor(Math.random()*100001);var _count=result.Data.AutomaticWorkspaceInfo.Count;var _headlines=result.Data.AutomaticWorkspaceInfo.Headlines;var _curDivCntrId="autoWorkspace_"+randomnumber;sb[sb.length]="<div id=\""+_curDivCntrId+"\" class=\"fctv_AutoWrkSpcHeadlineCont\" style=\""+this.getInnerContainerStyle(bgColor,fontFamily,contentFontSize,contentColor)+"\">";if(_count>numHeadlines){sb[sb.length]=this.getPagingBar(numHeadlines,_count,result.Literals,"#e5e5e0",contentFontSize,"#333333",fontFamily,_curDivCntrId);} for(var j=0;j<_count;j++){var showHeadline=(j<numHeadlines);var _headline=_headlines[j];sb[sb.length]=this.getHeadline(bgColor,fontFamily,contentFontSize,contentColor,auxInfoColor,snippetColor,_headline,showHeadline,showSnippet,result.Literals);} if(_count>numHeadlines&&numHeadlines>1){sb[sb.length]=this.getPagingBar(numHeadlines,_count,result.Literals,"#e5e5e0",contentFontSize,"#333333",fontFamily,_curDivCntrId);} sb[sb.length]="</div>";} else if(result.Literals!=null&&result.Literals.NoResults!=null){sb[sb.length]=this.getNoResultsPanel(bgColor,fontFamily,contentFontSize,contentColor,result.Literals.NoResults);}} if(showTitle){sb[sb.length]="</div>";} if(result.Literals!=null&&result.Literals.CopyRight!=null){sb[sb.length]=this.getCopyRightPanel(metaRandomnumber,mColor,_fontFamilies[0],_fontSizes[1].contentFontSize+"px",contentColor,result.Literals.CopyRight,result.Literals.BrandingBadge,result.Literals.MarketingSiteUrl,result.Literals.MarketingSiteTitle,showTitle);} sb[sb.length]="</div>";this.xInnerHtml(tEle,sb.join(""));} else{this.xInnerHtml(tEle,"Service is unavailable.");} if(typeof(_IG_AdjustIFrameHeight)!="undefined"&&typeof(_IG_AdjustIFrameHeight)=="function"){window.setTimeout("_IG_AdjustIFrameHeight()",1);} var endTime=new Date();this.debugMsg("metaRandomnumber: "+metaRandomnumber+" Rendering Time: "+(endTime.getTime()-startTime.getTime())+"ms; ServerTime: "+serverTime+"ms");this.xInnerHtml(metaRandomnumber+"","{r:"+(endTime.getTime()-startTime.getTime())+";s:"+serverTime+"}");};this.xBuildAlertWidget=function(tEle,result,showTitle,integrateFontCSS){var startTime=new Date();var serverTime;var metaRandomnumber=Math.floor(Math.random()*100001);if(result!=null&&result.Definition!=null){var sb=[];serverTime=result.ElapsedTime;var mColor=result.Definition.MainColor;var mFontColor=result.Definition.MainFontColor;var aColor=result.Definition.AccentColor;var aFontColor=result.Definition.AccentFontColor;var contentColor=result.Definition.ContentFontColor;var snippetColor=result.Definition.SnippetFontColor;var auxInfoColor=result.Definition.AuxInfoFontColor;var bgColor=result.Definition.BackgroundColor;var widgetName=result.Definition.Name;var numHeadlines=result.Definition.NumOfHeadlines;var fontFamily=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"inherit":_fontFamilies[result.Definition.FontFamily];var contentFontSize=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"inherit":_fontSizes[result.Definition.FontSize].contentFontSize+"px";var titleFontSize=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"larger":_fontSizes[result.Definition.FontSize].titleFontSize+"px";var showSnippet=(result.Definition.DisplayType==1);this.appendTabStyles(tEle,(showTitle)?mColor:"#FFFFFF",mColor,showTitle,aColor,bgColor,(result.Literals)?result.Literals.CarouselLeft:null,(result.Literals)?result.Literals.CarouselRight:null);sb[sb.length]="<div id=\"scriptPreview\" style=\""+this.getOuterContainerStyle(bgColor,fontFamily,contentFontSize,(showTitle)?mColor:"#FFFFFF",contentColor)+"\">";if(showTitle){sb[sb.length]=this.getWidgetTitle(widgetName,mColor,titleFontSize,mFontColor,fontFamily,(result.Literals)?result.Literals.Icon:null);} if(result.ReturnCode!=0){this.xInnerHtml(tEle,result.ReturnCode+": "+result.StatusMessage);return;} else{if(result.Definition.DiscoveryTabs!=null){var discoveryTabs=result.Definition.DiscoveryTabs;var activeCount=0;for(var i=0;i<discoveryTabs.length;i++){var currentTab=discoveryTabs[i];if(currentTab.Active==true){activeCount++;}} sb[sb.length]=this.getTabPanelGroup(mColor,result.Literals,discoveryTabs,activeCount);} for(var i=0;i<discoveryTabs.length;i++){var currentTab=discoveryTabs[i];if(currentTab.Active==true){if(currentTab.Id=="headlines"){sb[sb.length]=this.getAlertHeadlinesPanel(tEle,result,showTitle,integrateFontCSS);} if(currentTab.Id=="companies"){sb[sb.length]=this.getAlertCompaniesPanel(tEle,result,showTitle,integrateFontCSS);} if(currentTab.Id=="subjects"){sb[sb.length]=this.getAlertSubjectsPanel(tEle,result,showTitle,integrateFontCSS);} if(currentTab.Id=="industries"){sb[sb.length]=this.getAlertIndustriesPanel(tEle,result,showTitle,integrateFontCSS);} if(currentTab.Id=="executives"){sb[sb.length]=this.getAlertExecutivesPanel(tEle,result,showTitle,integrateFontCSS);} if(currentTab.Id=="regions"){sb[sb.length]=this.getAlertRegionsPanel(tEle,result,showTitle,integrateFontCSS);}}} sb[sb.length]="</div>";} if(result.Literals!=null&&result.Literals.CopyRight!=null){sb[sb.length]=this.getCopyRightPanel(metaRandomnumber,mColor,_fontFamilies[0],_fontSizes[1].contentFontSize+"px",contentColor,result.Literals.CopyRight,result.Literals.BrandingBadge,result.Literals.MarketingSiteUrl,result.Literals.MarketingSiteTitle,showTitle);} sb[sb.length]="</div>";this.xInnerHtml(tEle,sb.join(""));if(result.ReturnCode==0){var tabHeight;switch(result.Definition.FontSize){case 0:tabHeight=20*(result.Definition.FontSize+1);break;case 1:tabHeight=10*(result.Definition.FontSize+1.5);break;case 2:tabHeight=8*(result.Definition.FontSize+1);break;case 3:tabHeight=7*(result.Definition.FontSize+1);break;case 4:tabHeight=5*(result.Definition.FontSize+1);break;case 5:tabHeight=5*(result.Definition.FontSize+1)-3;break;case 6:tabHeight=4*(result.Definition.FontSize+1);break;default:break;} var index=this.getIndex();this.xTabPanelGroup("fctv_tabpanelgroup"+index,0,0,tabHeight,"tabPanel","tabGroup","tabDefault","tabSelected",this.getIndex());this.setIndex(index+1);}} else{this.xInnerHtml(tEle,"Service is unavailable.");} if(typeof(_IG_AdjustIFrameHeight)!="undefined"&&typeof(_IG_AdjustIFrameHeight)=="function"){window.setTimeout("_IG_AdjustIFrameHeight()",1);} var endTime=new Date();this.debugMsg("metaRandomnumber: "+metaRandomnumber+" Rendering Time: "+(endTime.getTime()-startTime.getTime())+"ms; ServerTime: "+serverTime+"ms");this.xInnerHtml(metaRandomnumber+"","{r:"+(endTime.getTime()-startTime.getTime())+";s:"+serverTime+"}");};this.debugMsg=function(msg){if(window.console&&window.console.log){window.console.log(msg);} if(window.opera){window.opera.postError(msg);} if(window.debugService){window.debugService.trace(msg);}};this.getCopyRightPanel=function(metaRandomnumber,bgColor,fontFamily,fontSize,fontColor,token,badge,marketingUrl,title,showTitle){var t=[];t[t.length]="<div id=\"fctv_copyRight\" style=\""+";padding:3px 5px"+";color:"+fontColor+";font-size:"+fontSize+";font-family:"+fontFamily+";font-weight:normal"+";zoom:1"+";background-color:#FFF;"+";overflow:hidden;";if(showTitle){t[t.length]=";border-left: solid 1px "+bgColor+";border-right: solid 1px "+bgColor;} t[t.length]="\">";if(badge){t[t.length]="<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" summary=\"\">";t[t.length]="<tr><td colspan=\"2\"><b style=\"background-color:#999;display:block;height:1px;line-height:1px;overflow:hidden;width:100%;\"></b></td></tr>";t[t.length]="<tr><td align=\"left\" valign=\"bottom\">";t[t.length]="<a href=\""+marketingUrl+"\" target=\"_new\" title=\""+title+"\">";t[t.length]="<img src=\""+badge+"\" border=\"0\" />";t[t.length]="</a>";t[t.length]="</td>";t[t.length]="<td align=\"right\" valign=\"bottom\" width=\"100%\">";t[t.length]="<div id=\"fctv_copyRight\" style=\""+";padding-bottom:2px"+";color:"+fontColor+";font-size:"+fontSize+";font-family:"+fontFamily+";font-weight:normal;"+"\">";t[t.length]="<span id=\""+metaRandomnumber+"\" style=\"color:#FFF;\"></span>";t[t.length]=token;t[t.length]="</div></td>";t[t.length]="</tr></table>";} else{t[t.length]="<span id=\""+metaRandomnumber+"\" style=\"color:#FFF;\"></span>";t[t.length]=token;} t[t.length]="</div>";if(showTitle){t[t.length]="<b style=\"display:block;font-family:Arial;width:100%;\">";t[t.length]="<b style=\""+"background-color: #FFF;"+";border-left: solid 1px "+bgColor+";border-right: solid 1px "+bgColor+";margin:0 1px"+";line-height:1px;height:2px;overflow:hidden;display:block;"+"\"></b>";t[t.length]="<b style=\""+"background-color: #FFF;"+";border-left: solid 2px "+bgColor+";border-right: solid 2px "+bgColor+";margin:0 2px"+";line-height:1px;height:1px;overflow:hidden;display:block;"+"\"></b>";t[t.length]="<b style=\""+"background-color:"+bgColor+";border-left: solid 1px "+bgColor+";border-right: solid 1px "+bgColor+";margin:0 4px"+";line-height:1px;height:1px;overflow:hidden;display:block;"+"\"></b>";t[t.length]="</b>";} return t.join("");};this.getLinkStyles=function(){var sb=[];sb[sb.length]=[];};this.getNoResultsPanel=function(bgColor,fontFamily,fontSize,fontColor,token){return"<div id=\"fctv_headline\" style=\""+"background-color:"+bgColor+";padding:3px 5px"+";color:"+fontColor+";font-size:"+fontSize+";font-family:"+fontFamily+";font-weight:normal"+"\">"+token+"</div>";};this.getHeadline=function(bgColor,fontFamily,fontSize,fontColor,auxInfoColor,snippetColor,headline,showHeadline,showSnippet,literals){var sb=[];sb[sb.length]="<div class=\"fctv_headlineCont\" style=\"display:"+((showHeadline&&showHeadline==true)?"block":"none")+"\">";var tImg="";var defaultPadding="3px 3px";if(this.xStr(headline.IconUrl)&&headline.IconUrl!=null&&headline.IconUrl.length>0){tImg=headline.IconUrl;} sb[sb.length]="<div class=\"fctv_healineIcon\" style=\"position:relative; background:"+bgColor+" url("+tImg+") no-repeat 3px 3px;\">";sb[sb.length]="<div id=\"fctv_headline\" style=\""+";padding:3px 5px"+";margin-left:15px"+";padding-bottom:0"+";color:"+fontColor+";font-size:"+fontSize+";font-family:"+fontFamily+";font-weight:normal\">";if(literals&&this.xStr(literals.ImportanceFlagUrl)&&literals.ImportanceFlagUrl!=null&&literals.ImportanceFlagUrl.length>0){switch(headline.Importance){case 0:default:break;case 1:sb[sb.length]="<span class=\"fctv_importance\" style=\"border: solid 1px #000; padding-right:0.3em;padding-left:0.3em;font-weight:bold; padding-bottom:0.1em;color:#30332d;padding-top:0.1em;\">"+literals.Hot+"</span>&nbsp;";break;case 2:sb[sb.length]="<span class=\"fctv_importance\" style=\"border: solid 1px #000; padding-right:0.3em;padding-left:0.3em;font-weight:bold; padding-bottom:0.1em;color:#30332d;padding-top:0.1em;\">"+literals.New+"</span>&nbsp;";break;case 3:sb[sb.length]="<span class=\"fctv_importance\" style=\"border: solid 1px #000; padding-right:0.3em;padding-left:0.3em;font-weight:bold; padding-bottom:0.1em;color:#30332d;padding-top:0.1em;\">"+literals.MustRead+"</span>&nbsp;";break;}} sb[sb.length]="<a class=\"factivaLink\" href=\"javascript:void(0)\" onclick=\"return false;\" style=\"font-weight:bold;color:"+fontColor+";text-decoration:none;\" onmouseover=\"FactivaWidgetRenderManager.getInstance().setMouseOver(this);return false;\" onmouseout=\"FactivaWidgetRenderManager.getInstance().setMouseOut(this);return false;\" title=\""+((!showSnippet)?headline.Snippet.replace("\"","&quot;"):headline.Text.replace("\"","&quot;"))+"\">"+((headline.TruncText!=null&&headline.TruncText.length>0)?headline.TruncText:headline.Text)+"</a></div>";var t=[];if(this.xStr(headline.SrcName)&&headline.SrcName!=null&&headline.SrcName.length>0){t[t.length]=headline.SrcName;} if(this.xStr(headline.PubDateTime)&&headline.PubDateTime!=null&&headline.PubDateTime.length>0){(t.length>0)?t[t.length]=", ":"";t[t.length]=headline.PubDateTime;} if(this.xStr(headline.WordCount)&&headline.WordCount!=null&&headline.WordCount.length>0){(t.length>0)?t[t.length]=", ":"";t[t.length]=headline.WordCount;} if(this.xStr(headline.Lang)&&headline.Lang!=null&&headline.Lang.length>0){(t.length>0)?t[t.length]=", ":"";t[t.length]=headline.Lang;} if(t.length>0){sb[sb.length]="<div id=\"fctv_auxInfo\" style=\""+";padding:3px 5px"+";padding-top:2px"+";margin-left:15px;"+";padding-bottom:0"+";color:"+auxInfoColor+";font-size:"+fontSize+";font-family:"+fontFamily+";font-weight:normal"+"\">";sb[sb.length]=t.join("");sb[sb.length]="</div>";} if(showSnippet){sb[sb.length]="<div id=\"fctv_snippet\" style=\""+";padding:3px 5px"+";padding-top:2px"+";margin-left:15px;"+";color:"+snippetColor+";font-size:"+fontSize+";font-family:"+fontFamily+";font-weight:normal"+"\">"+headline.Snippet+"</div>";} if(this.xStr(headline.Comment)&&headline.Comment!=null&&headline.Comment.length>0){sb[sb.length]="<div id=\"fctv_comment\" style=\""+";padding:3px 5px"+";padding-top:2px"+";margin-left:15px;"+";color:"+fontColor+";font-size:"+fontSize+";font-family:"+fontFamily+";font-weight:normal"+"\">"+headline.Comment+"</div>";} sb[sb.length]="</div>";sb[sb.length]="</div>";return sb.join("");};this.getOuterContainerStyle=function(bgColor,fontFamily,fontSize,borderColor,fontColor){return"background-color:"+bgColor+";font-family:"+fontFamily+";font-size:"+fontSize+";color:"+fontColor+";font-weight:normal"+";";};this.getBorderStyle=function(bgColor,fontFamily,fontSize,borderColor,fontColor){return"background-color:"+bgColor+";font-family:"+fontFamily+";font-size:12"+";color:"+fontColor+";font-weight:normal"+";border-left:solid 1px "+borderColor+";border-right:solid 1px "+borderColor+";zoom:1;";};this.getTabPanelGroup=function(mColor,_literals,_discoveryTabs,activeCount){var t=[];t[t.length]="<div id=\"fctv_tabpanelgroup"+this.getIndex()+"\" class=\"tabPanelGroup\" >";t[t.length]=(activeCount!=1)?"<div style=\"display:block;padding-bottom:10px;position:relative;zoom:1;\" >":"<div style=\"position:absolute;height:0px;left:0px;top:0px;width:0px;\" >";t[t.length]=this.getTabPanels(_literals,_discoveryTabs);t[t.length]="</div>";return t.join("");};this.getTabPanels=function(_literals,_discoveryTabs){var t=[];t[t.length]="<div id=\"fctv_tabLeft"+this.getIndex()+"\" class=\"tabLeft\" "+" onclick=\"FactivaWidgetRenderManager.getInstance().moveRightTab("+this.getIndex()+");return false;\"></div>";t[t.length]="<div id=\"fctv_tabgroup_outer"+this.getIndex()+"\" class=\"tabGroupOuterContainer\">";t[t.length]="<div id=\"fctv_tabgroup"+this.getIndex()+"\" class=\"tabGroup\">";for(var i=0;i<_discoveryTabs.length;i++){var currentTab=_discoveryTabs[i];if(currentTab.Active==true){if(currentTab.Id=="headlines")t[t.length]="<a id=\""+currentTab.Id+"_tab\" href=\"javascript:void(0)\" style=\"outline:none;\" title=\""+_literals.Headlines+"\" class=\"tabDefault\">&nbsp;&nbsp;"+_literals.Headlines+"&nbsp;&nbsp;</a>";if(currentTab.Id=="companies")t[t.length]="<a id=\""+currentTab.Id+"_tab\" href=\"javascript:void(0)\" style=\"outline:none;\" title=\""+_literals.Companies+"\" class=\"tabDefault\">&nbsp;&nbsp;"+_literals.Companies+"&nbsp;&nbsp;</a>";if(currentTab.Id=="subjects")t[t.length]="<a id=\""+currentTab.Id+"_tab\" href=\"javascript:void(0)\" style=\"outline:none;\" title=\""+_literals.Subjects+"\" class=\"tabDefault\">&nbsp;&nbsp;"+_literals.Subjects+"&nbsp;&nbsp;</a>";if(currentTab.Id=="industries")t[t.length]="<a id=\""+currentTab.Id+"_tab\" href=\"javascript:void(0)\" style=\"outline:none;\" title=\""+_literals.Industries+"\" class=\"tabDefault\">&nbsp;&nbsp;"+_literals.Industries+"&nbsp;&nbsp;</a>";if(currentTab.Id=="executives")t[t.length]="<a id=\""+currentTab.Id+"_tab\" href=\"javascript:void(0)\" style=\"outline:none;\" title=\""+_literals.Executives+"\" class=\"tabDefault\">&nbsp;&nbsp;"+_literals.Executives+"&nbsp;&nbsp;</a>";if(currentTab.Id=="regions")t[t.length]="<a id=\""+currentTab.Id+"_tab\" href=\"javascript:void(0)\" style=\"outline:none;\" title=\""+_literals.Regions+"\" class=\"tabDefault\">&nbsp;&nbsp;"+_literals.Regions+"&nbsp;&nbsp;</a>";}} t[t.length]="&nbsp;</div>";t[t.length]="</div>";t[t.length]="<div id=\"fctv_tabRight"+this.getIndex()+"\" class=\"tabRight\" "+" onclick=\"FactivaWidgetRenderManager.getInstance().moveLeftTab("+this.getIndex()+");return false;\"></div>";return t.join("");};this.appendTabStyles=function(tEle,mColor,tabmColor,showTitle,aColor,bgColor,leftCarouselIcon,rightCarouselIcon){var rgb=this.unpack(aColor);var hsl=this.RGBToHSL(rgb);var tabStyles="#"+this.xGetElementById(tEle).id+" .tabPanelGroup{overflow:hidden;zoom:1"+";border-left:1px solid "+mColor+";border-right:1px solid "+mColor+";} "+"#"+this.xGetElementById(tEle).id+" .tabPanel{display:block;float:left;overflow:hidden;position:relative;width:100%;}"+"#"+this.xGetElementById(tEle).id+" .tabGroupOuterContainer{display:inline-block;float:left;margin-bottom:10px;overflow:hidden;position:relative;width:100%;}"+"#"+this.xGetElementById(tEle).id+" .tabLeft{"+"background: url("+leftCarouselIcon+") no-repeat center center"+";background-color: #DDDDDD"+";border:1px solid "+tabmColor+";border-top:none"+";cursor:pointer"+";display:none"+";float:left"+";left:0px"+";outline:none"+";position:absolute"+";width:20px"+";top:0px"+";visibility:hidden"+";} "+"#"+this.xGetElementById(tEle).id+" .tabLeftGutter{"+"border-bottom:1px solid "+tabmColor+";background-color:#FFFFFF"+";filter:alpha(opacity=65)"+";float:left"+";opacity:0.65"+";outline:none"+";left:0px"+";position:absolute"+";top:0px"+";} "+"#"+this.xGetElementById(tEle).id+" .tabRight{"+"background: url("+rightCarouselIcon+") no-repeat center center"+";border:1px solid "+tabmColor+";border-top:none"+";cursor:pointer"+";display:none"+";float:left"+";right:0px"+";outline:none"+";position:absolute"+";width:20px"+";top:0px"+";visibility:hidden"+";} "+"#"+this.xGetElementById(tEle).id+" .tabRightGutter{"+"border-bottom:1px solid "+tabmColor+";background-color:#FFFFFF"+";filter:alpha(opacity=65)"+";float:left"+";opacity:0.65"+";outline:none"+";right:0px"+";position:absolute"+";top:0px"+";} "+"#"+this.xGetElementById(tEle).id+" .tabGroup{display:block;margin:0 auto;overflow:hidden;position:relative;}"+"#"+this.xGetElementById(tEle).id+" .tabGroup a.tabDefault:link"+", #"+this.xGetElementById(tEle).id+" .tabGroup a.tabDefault:visited"+", #"+this.xGetElementById(tEle).id+" .tabGroup a.tabDefault:active"+", #"+this.xGetElementById(tEle).id+" .tabDefault{background:"+aColor+" none repeat scroll 0 0"+";border:1px solid "+tabmColor+";border-top:none"+";color:"+(hsl[2]>0.5?"#000":"#fff")+";cursor:pointer"+";display:inline-block"+";filter:alpha(opacity=65)"+";float:left"+";font-weight:bold"+";opacity:0.65"+";padding-top:5px"+";text-align:center"+";text-decoration:none"+";zoom:1"+";} "+"#"+this.xGetElementById(tEle).id+" .tabGroup a.tabDefault:hover"+", #"+this.xGetElementById(tEle).id+" .tabDefault:hover{background:"+bgColor+" none repeat scroll 0 0"+";border:1px solid "+tabmColor+";border-top:none"+";border-bottom:1px solid white"+";color: #333"+";cursor:pointer"+";display:inline-block"+";filter:alpha(opacity=100)"+";float:left"+";font-weight:bold"+";opacity:1.0"+";padding-top:5px"+";text-align:center"+";text-decoration:none"+";zoom:1"+";} "+"#"+this.xGetElementById(tEle).id+" .tabGroup a.tabSelected:link"+", #"+this.xGetElementById(tEle).id+" .tabGroup a.tabSelected:visited"+", #"+this.xGetElementById(tEle).id+" .tabGroup a.tabSelected:active"+", #"+this.xGetElementById(tEle).id+" .tabGroup a.tabSelected:hover"+", #"+this.xGetElementById(tEle).id+" .tabSelected{background:"+bgColor+" none repeat scroll 0 0"+";border-left:1px solid "+tabmColor+";border-right:1px solid "+tabmColor+";border-top:none"+";border-bottom:1px solid white"+";color:#000"+";cursor:pointer"+";display:inline-block"+";float:left"+";font-weight:bold"+";padding-top:5px"+";text-align:center"+";text-decoration:none"+";zoom:1"+";} ";var headID=document.getElementsByTagName("head")[0];var TabCSS=this.xGetElementById("tabStyles");if(TabCSS!=null){} var cssNode=document.createElement("style");cssNode.id="tabStyles";cssNode.setAttribute("type","text/css");if(cssNode.styleSheet){cssNode.styleSheet.cssText=tabStyles;} else{var cssText=document.createTextNode(tabStyles);cssNode.appendChild(cssText);} headID.appendChild(cssNode);};this.getAlertHeadlinesPanel=function(tEle,result,showTitle,integrateFontCSS){if(result!=null&&result.Definition!=null){var mColor=result.Definition.MainColor;var mFontColor=result.Definition.MainFontColor;var aColor=result.Definition.AccentColor;var aFontColor=result.Definition.AccentFontColor;var contentColor=result.Definition.ContentFontColor;var snippetColor=result.Definition.SnippetFontColor;var auxInfoColor=result.Definition.AuxInfoFontColor;var bgColor=result.Definition.BackgroundColor;var widgetName=result.Definition.Name;var numHeadlines=result.Definition.NumOfHeadlines;var fontFamily=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"inherit":_fontFamilies[result.Definition.FontFamily];var contentFontSize=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"inherit":_fontSizes[result.Definition.FontSize].contentFontSize+"px";var titleFontSize=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"larger":_fontSizes[result.Definition.FontSize].titleFontSize+"px";var showSnippet=(result.Definition.DisplayType==1);} var t=[];t[t.length]="<div id=\"alertHeadlinesPanel\" class=\"tabPanel\">";if(result.ReturnCode!=0&&tEle){this.xInnerHtml(tEle,result.ReturnCode+": "+result.StatusMessage);return;} if(result.Data!=null&&result.Data.Count>0){for(var i=0;i<result.Data.Count;i++){var _alert=result.Data.Alerts[i];if(_alert.Status.Code==0){t[t.length]=this.getAlertTitle(_alert,result.Literals,aColor,titleFontSize,aFontColor,fontFamily);if(_alert.HeadlineCount>0){var randomnumber=Math.floor(Math.random()*100001);var _curDivCntrId="folder_"+_alert.Id+"_"+randomnumber;t[t.length]="<div id=\""+_curDivCntrId+"\" class=\"fctv_AlertHeadlineCont\" style=\""+this.getInnerContainerStyle(bgColor,fontFamily,contentFontSize,contentColor)+"\">";if(_alert.HeadlineCount>numHeadlines&&numHeadlines!=0){t[t.length]=this.getPagingBar(numHeadlines,_alert.HeadlineCount,result.Literals,"#e5e5e0",contentFontSize,"#333333",fontFamily,_curDivCntrId,_alert);} for(var j=0;j<_alert.HeadlineCount;j++){var showHeadline=(j<numHeadlines);var _headline=_alert.Headlines[j];t[t.length]=this.getHeadline(bgColor,fontFamily,contentFontSize,contentColor,auxInfoColor,snippetColor,_headline,showHeadline,showSnippet,result.Literals);} if(_alert.HeadlineCount>numHeadlines&&numHeadlines!=0){t[t.length]=this.getPagingBar(numHeadlines,_alert.HeadlineCount,result.Literals,"#e5e5e0",contentFontSize,"#333333",fontFamily,_curDivCntrId,_alert);} t[t.length]="</div>";} else if(result.Literals!=null&&result.Literals.NoResults!=null){t[t.length]=this.getNoResultsPanel(bgColor,fontFamily,contentFontSize,contentColor,result.Literals.NoResults);}}}} t[t.length]="</div>";return t.join("");};this.addFlashImage=function(chartdata){if(chartdata!=null&&chartdata.data.length>0){if(typeof(FlashObject)!='undefined'){var fo=new FlashObject(chartdata.chartUri,"temp_swf",chartdata.width,chartdata.height,chartdata.version);var t=[];if(xIE4Up){t[t.length]="<div style=\"margin:10px auto 10px auto"+";position:relative"+";text-align:center"+";\">"+fo.getFlashHTML()+"</div>";} else{t[t.length]="<div style=\"margin:10px auto 10px auto"+";position:relative"+";width:"+chartdata.width+"px"+";\">"+fo.getFlashHTML()+"</div>";} return t.join("");}}};this.addGetThisAlertUrl=function(url,token,mColor){if(url!=null){var t=[];t[t.length]="<div style=\"display:block;padding:5px 0 5px 0;position:relative\">";t[t.length]="<a id=\"getAlert\" href=\"javascript:void(0)\""+" onclick=\"alert(translate('featureIsDisabled'));return false;\"title=\""+token+"\""+" onmouseover=\"FactivaWidgetRenderManager.getInstance().setMouseOver(this);return false;\""+" onmouseout=\"FactivaWidgetRenderManager.getInstance().setMouseOut(this);return false;\""+" style=\"color:"+mColor+";font-size:10px"+";font-weight:normal"+";margin:5px"+";outline:none"+";position:relative"+";text-decoration:none;\">"+token+"</a>";t[t.length]="</div>";return t.join("");}};this.getAlertCompaniesPanel=function(tEle,result,showTitle,integrateFontCSS){if(result!=null&&result.Definition!=null){var mColor=result.Definition.MainColor;var mFontColor=result.Definition.MainFontColor;var aColor=result.Definition.AccentColor;var aFontColor=result.Definition.AccentFontColor;var contentColor=result.Definition.ContentFontColor;var snippetColor=result.Definition.SnippetFontColor;var auxInfoColor=result.Definition.AuxInfoFontColor;var bgColor=result.Definition.BackgroundColor;var widgetName=result.Definition.Name;var numHeadlines=result.Definition.NumOfHeadlines;var fontFamily=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"inherit":_fontFamilies[result.Definition.FontFamily];var contentFontSize=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"inherit":_fontSizes[result.Definition.FontSize].contentFontSize+"px";var titleFontSize=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"larger":_fontSizes[result.Definition.FontSize].titleFontSize+"px";var showSnippet=(result.Definition.DisplayType==1);} var t=[];t[t.length]="<div id=\"alertCompaniesPanel\" class=\"tabPanel\">";if(result.ReturnCode!=0&&tEle){this.xInnerHtml(tEle,result.ReturnCode+": "+result.StatusMessage);return;} if(result.Data!=null&&result.Data.Count>0){for(var i=0;i<result.Data.Count;i++){var _alert=result.Data.Alerts[i];if(_alert.Status.Code==0){t[t.length]=this.getAlertTitle(_alert,result.Literals,aColor,titleFontSize,aFontColor,fontFamily);if(_alert.CompaniesChart!=null){t[t.length]=this.addFlashImage(_alert.CompaniesChart.Chart);if(result.Data.Alerts[i].IsGroupFolder==false){if(result.Definition.DistributionType==0||result.Definition.DistributionType==1)t[t.length]=this.addGetThisAlertUrl(_alert.CompaniesChart.GetThisAlertUrl,result.Literals.GetThisAlert,mColor);}} else if(result.Literals!=null&&result.Literals.NoResults!=null){t[t.length]=this.getNoResultsPanel(bgColor,fontFamily,contentFontSize,contentColor,result.Literals.NoResults);}}}} t[t.length]="</div>";return t.join("");};this.getAlertSubjectsPanel=function(tEle,result,showTitle,integrateFontCSS){if(result!=null&&result.Definition!=null){var mColor=result.Definition.MainColor;var mFontColor=result.Definition.MainFontColor;var aColor=result.Definition.AccentColor;var aFontColor=result.Definition.AccentFontColor;var contentColor=result.Definition.ContentFontColor;var snippetColor=result.Definition.SnippetFontColor;var auxInfoColor=result.Definition.AuxInfoFontColor;var bgColor=result.Definition.BackgroundColor;var widgetName=result.Definition.Name;var numHeadlines=result.Definition.NumOfHeadlines;var fontFamily=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"inherit":_fontFamilies[result.Definition.FontFamily];var contentFontSize=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"inherit":_fontSizes[result.Definition.FontSize].contentFontSize+"px";var titleFontSize=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"larger":_fontSizes[result.Definition.FontSize].titleFontSize+"px";var showSnippet=(result.Definition.DisplayType==1);} var t=[];t[t.length]="<div id=\"alertSubjectsPanel\" class=\"tabPanel\">";if(result.ReturnCode!=0&&tEle){this.xInnerHtml(tEle,result.ReturnCode+": "+result.StatusMessage);return;} if(result.Data!=null&&result.Data.Count>0){for(var i=0;i<result.Data.Count;i++){var _alert=result.Data.Alerts[i];if(_alert.Status.Code==0){t[t.length]=this.getAlertTitle(_alert,result.Literals,aColor,titleFontSize,aFontColor,fontFamily);if(_alert.SubjectsChart!=null){t[t.length]=this.addFlashImage(_alert.SubjectsChart.Chart);if(result.Data.Alerts[i].IsGroupFolder==false){if(result.Definition.DistributionType==0||result.Definition.DistributionType==1)t[t.length]=this.addGetThisAlertUrl(_alert.SubjectsChart.GetThisAlertUrl,result.Literals.GetThisAlert,mColor);}} else if(result.Literals!=null&&result.Literals.NoResults!=null){t[t.length]=this.getNoResultsPanel(bgColor,fontFamily,contentFontSize,contentColor,result.Literals.NoResults);}}}} t[t.length]="</div>";return t.join("");};this.getAlertIndustriesPanel=function(tEle,result,showTitle,integrateFontCSS){if(result!=null&&result.Definition!=null){var mColor=result.Definition.MainColor;var mFontColor=result.Definition.MainFontColor;var aColor=result.Definition.AccentColor;var aFontColor=result.Definition.AccentFontColor;var contentColor=result.Definition.ContentFontColor;var snippetColor=result.Definition.SnippetFontColor;var auxInfoColor=result.Definition.AuxInfoFontColor;var bgColor=result.Definition.BackgroundColor;var widgetName=result.Definition.Name;var numHeadlines=result.Definition.NumOfHeadlines;var fontFamily=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"inherit":_fontFamilies[result.Definition.FontFamily];var contentFontSize=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"inherit":_fontSizes[result.Definition.FontSize].contentFontSize+"px";var titleFontSize=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"larger":_fontSizes[result.Definition.FontSize].titleFontSize+"px";var showSnippet=(result.Definition.DisplayType==1);} var t=[];t[t.length]="<div id=\"alertIndustriesPanel\" class=\"tabPanel\">";if(result.ReturnCode!=0&&tEle){this.xInnerHtml(tEle,result.ReturnCode+": "+result.StatusMessage);return;} if(result.Data!=null&&result.Data.Count>0){for(var i=0;i<result.Data.Count;i++){var _alert=result.Data.Alerts[i];if(_alert.Status.Code==0){t[t.length]=this.getAlertTitle(_alert,result.Literals,aColor,titleFontSize,aFontColor,fontFamily);if(_alert.IndustriesChart!=null){t[t.length]=this.addFlashImage(_alert.IndustriesChart.Chart);if(result.Data.Alerts[i].IsGroupFolder==false){if(result.Definition.DistributionType==0||result.Definition.DistributionType==1)t[t.length]=this.addGetThisAlertUrl(_alert.IndustriesChart.GetThisAlertUrl,result.Literals.GetThisAlert,mColor);}} else if(result.Literals!=null&&result.Literals.NoResults!=null){t[t.length]=this.getNoResultsPanel(bgColor,fontFamily,contentFontSize,contentColor,result.Literals.NoResults);}}}} t[t.length]="</div>";return t.join("");};this.getAlertExecutivesPanel=function(tEle,result,showTitle,integrateFontCSS){if(result!=null&&result.Definition!=null){var mColor=result.Definition.MainColor;var mFontColor=result.Definition.MainFontColor;var aColor=result.Definition.AccentColor;var aFontColor=result.Definition.AccentFontColor;var contentColor=result.Definition.ContentFontColor;var snippetColor=result.Definition.SnippetFontColor;var auxInfoColor=result.Definition.AuxInfoFontColor;var bgColor=result.Definition.BackgroundColor;var widgetName=result.Definition.Name;var numHeadlines=result.Definition.NumOfHeadlines;var fontFamily=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"inherit":_fontFamilies[result.Definition.FontFamily];var contentFontSize=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"inherit":_fontSizes[result.Definition.FontSize].contentFontSize+"px";var titleFontSize=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"larger":_fontSizes[result.Definition.FontSize].titleFontSize+"px";var showSnippet=(result.Definition.DisplayType==1);} var t=[];t[t.length]="<div id=\"alertExecutivesPanel\" class=\"tabPanel\">";if(result.ReturnCode!=0&&tEle){this.xInnerHtml(tEle,result.ReturnCode+": "+result.StatusMessage);return;} if(result.Data!=null&&result.Data.Count>0){for(var i=0;i<result.Data.Count;i++){var _alert=result.Data.Alerts[i];if(_alert.Status.Code==0){t[t.length]=this.getAlertTitle(_alert,result.Literals,aColor,titleFontSize,aFontColor,fontFamily);if(_alert.ExecutivesChart!=null){t[t.length]=this.addFlashImage(_alert.ExecutivesChart.Chart);if(result.Data.Alerts[i].IsGroupFolder==false){if(result.Definition.DistributionType==0||result.Definition.DistributionType==1)t[t.length]=this.addGetThisAlertUrl(_alert.ExecutivesChart.GetThisAlertUrl,result.Literals.GetThisAlert,mColor);}} else if(result.Literals!=null&&result.Literals.NoResults!=null){t[t.length]=this.getNoResultsPanel(bgColor,fontFamily,contentFontSize,contentColor,result.Literals.NoResults);}}}} t[t.length]="</div>";return t.join("");};this.getAlertRegionsPanel=function(tEle,result,showTitle,integrateFontCSS){if(result!=null&&result.Definition!=null){var mColor=result.Definition.MainColor;var mFontColor=result.Definition.MainFontColor;var aColor=result.Definition.AccentColor;var aFontColor=result.Definition.AccentFontColor;var contentColor=result.Definition.ContentFontColor;var snippetColor=result.Definition.SnippetFontColor;var auxInfoColor=result.Definition.AuxInfoFontColor;var bgColor=result.Definition.BackgroundColor;var widgetName=result.Definition.Name;var numHeadlines=result.Definition.NumOfHeadlines;var fontFamily=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"inherit":_fontFamilies[result.Definition.FontFamily];var contentFontSize=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"inherit":_fontSizes[result.Definition.FontSize].contentFontSize+"px";var titleFontSize=(typeof(integrateFontCSS)==='boolean'&&integrateFontCSS==true)?"larger":_fontSizes[result.Definition.FontSize].titleFontSize+"px";var showSnippet=(result.Definition.DisplayType==1);} var t=[];t[t.length]="<div id=\"alertRegionsPanel\" class=\"tabPanel\">";if(result.ReturnCode!=0&&tEle){this.xInnerHtml(tEle,result.ReturnCode+": "+result.StatusMessage);return;} if(result.Data!=null&&result.Data.Count>0){for(var i=0;i<result.Data.Count;i++){var _alert=result.Data.Alerts[i];if(_alert.Status.Code==0){t[t.length]=this.getAlertTitle(_alert,result.Literals,aColor,titleFontSize,aFontColor,fontFamily);if(_alert.RegionsChart!=null){t[t.length]=this.addFlashImage(_alert.RegionsChart.Chart);if(result.Data.Alerts[i].IsGroupFolder==false){if(result.Definition.DistributionType==0||result.Definition.DistributionType==1)t[t.length]=this.addGetThisAlertUrl(_alert.RegionsChart.GetThisAlertUrl,result.Literals.GetThisAlert,mColor);}} else if(result.Literals!=null&&result.Literals.NoResults!=null){t[t.length]=this.getNoResultsPanel(bgColor,fontFamily,contentFontSize,contentColor,result.Literals.NoResults);}}}} t[t.length]="</div>";return t.join("");};this.getInnerContainerStyle=function(bgColor,fontFamily,fontSize,fontColor){return"background-color:"+bgColor+";font-family:"+fontFamily+";font-size:"+fontSize+";color:"+fontColor+";font-weight:normal;overflow:hidden;"+";padding:0 5px;";};this.getWidgetTitle=function(widgetName,bgColor,fontSize,fontColor,fontFamily,icon){var t=[];t[t.length]="<b style=\"font-family:Arial\">";t[t.length]="<b style=\""+"background-color:"+bgColor+";margin:0 4px"+";line-height:1px;height:1px;overflow:hidden;display:block;"+"\"></b>";t[t.length]="<b style=\""+"background-color:"+bgColor+";border-left: solid 2px "+bgColor+";border-right: solid 2px "+bgColor+";margin:0 2px"+";line-height:1px;height:1px;overflow:hidden;display:block;"+"\"></b>";t[t.length]="<b style=\""+"background-color:"+bgColor+";margin:0 1px"+";line-height:2px;height:2px;overflow:hidden;display:block;"+"\"></b>";t[t.length]="</b>";t[t.length]="<div id=\"fctv_AlertWidgetTitle\" style=\""+"background-color:"+bgColor+";padding:3px 5px"+";padding-top:0px"+";color:"+fontColor+";font-size:"+fontSize+";font-family:"+fontFamily+";font-weight:bold;\">";if(icon){t[t.length]="<span style=\"margin-right:5px;\"><img src=\""+icon+"\" style=\"position:relative;top:3px;\" /></span>";t[t.length]="<span>"+widgetName+"</span>";} else{t[t.length]=widgetName;} t[t.length]="</div>";return t.join("");};this.getAlertTitle=function(_alert,_literals,bgColor,fontSize,fontColor,fontFamily){var t=[];t[t.length]="<div id=\"fctv_AlertTitle\" style=\""+"background-color:"+bgColor+";padding:3px 5px"+";color:"+fontColor+";font-size:"+fontSize+";font-family:"+fontFamily+";font-weight:bold"+"\">";t[t.length]="<a href=\"javascript:void(0)\" style=\"color:"+fontColor+"; text-decoration:none;\" onmouseover=\"FactivaWidgetRenderManager.getInstance().setMouseOver(this);return false;\" onmouseout=\"FactivaWidgetRenderManager.getInstance().setMouseOut(this);return false;\" onclick=\"alert(translate('featureIsDisabled'));return false;\" title=\""+_literals.ViewAll+"\">"+_alert.Name+"</a>";t[t.length]="</div>";return t.join("");};this.getSectionTitle=function(_section,bgColor,fontSize,fontColor,fontFamily){var t=[];t[t.length]="<div id=\"fctv_AlertTitle\" style=\""+"background-color:"+bgColor+";padding:3px 5px"+";color:"+fontColor+";font-size:"+fontSize+";font-family:"+fontFamily+";font-weight:bold"+"\">";t[t.length]="<span style=\"color:"+fontColor+"\">"+_section.Name+"</span>";t[t.length]="</div>";return t.join("");};this.getNext=function(ele,tarDivCntrId,numHeadlines){var _tDiv=this.xGetElementById(tarDivCntrId);if(_tDiv){var _headlines=this.xGetElementsByClassName("fctv_headlineCont",_tDiv,"div");if(_headlines&&_headlines.length>=1){var curPage=(typeof(_tDiv.CurPage)=="undefined")?1:_tDiv.CurPage;var tPages=Math.ceil(_headlines.length/numHeadlines);var tIndex=this.findPageIndex(_headlines)+numHeadlines;if(curPage>=tPages){tIndex=0;curPage=1;} else curPage++;for(var i=tIndex;(i<(tIndex+numHeadlines)&&i<_headlines.length);i++){this.xDisplay(_headlines[i],"block");} _tDiv.CurPage=curPage;this.updatePageText(_tDiv,tIndex,numHeadlines,_headlines.length);}} if(typeof(_IG_AdjustIFrameHeight)!="undefined"&&typeof(_IG_AdjustIFrameHeight)=="function"){window.setTimeout("_IG_AdjustIFrameHeight()",1);}};this.getPrevious=function(ele,tarDivCntrId,numHeadlines){var _tDiv=this.xGetElementById(tarDivCntrId);if(_tDiv){var _headlines=this.xGetElementsByClassName("fctv_headlineCont",_tDiv,"div");if(_headlines&&_headlines.length>=1){var curPage=(typeof(_tDiv.CurPage)=="undefined")?1:_tDiv.CurPage;var tPages=Math.ceil(_headlines.length/numHeadlines);var tIndex=this.findPageIndex(_headlines)-numHeadlines;if(curPage<=1){tIndex=(tPages-1)*numHeadlines;curPage=tPages;} else curPage--;for(var i=tIndex;(i<(tIndex+numHeadlines)&&i<_headlines.length);i++){this.xDisplay(_headlines[i],"block");} _tDiv.CurPage=curPage;this.updatePageText(_tDiv,tIndex,numHeadlines,_headlines.length);}} if(typeof(_IG_AdjustIFrameHeight)!="undefined"&&typeof(_IG_AdjustIFrameHeight)=="function"){window.setTimeout("_IG_AdjustIFrameHeight()",1);}};this.updatePageText=function(tDiv,index,size,max){var pCntrs=this.xGetElementsByClassName("pageText",tDiv,"span");if(pCntrs&&pCntrs.length>0){var token="&nbsp;"+(index+1)+"-"+((index+size>max)?max:index+size)+" of "+max+"&nbsp;";for(var i=0;i<pCntrs.length;i++){this.xInnerHtml(pCntrs[i],token)}}};this.findPageIndex=function(headlines){found=-1;for(var j=0;j<headlines.length;j++){if(this.xDisplay(headlines[j])=='block'){if(found==-1){found=j;}} this.xDisplay(headlines[j],"none");} return found;};this.xViewAlertFolder=function(linkEle,alertEle,moreToken,lessToken,numHeadlines){var _aEle=this.xGetElementById(alertEle);var _lEle=this.xGetElementById(linkEle);var _sAllEle=this.xGetElementById(_lEle.id.replace("v_","s_"));var _divisor=1;if(_aEle&&_lEle){var _headlines=this.xGetElementsByClassName("fctv_headlineCont",_aEle,"div");if(_headlines&&_headlines.length>=1){var IsMore=(typeof(_lEle.IsMore)=="undefined")?true:_lEle.IsMore;if(IsMore){this.xHeight(_aEle,_divisor*this.xHeight(_aEle));if(this.xDef(_aEle.style.overflowX)){_aEle.style.overflowX="hidden";_aEle.style.overflowY="scroll";} else{_aEle.style.overflow="-moz-scrollbars-vertical";} this.xInnerHtml(_lEle,lessToken);_lEle.title=lessToken;_lEle.IsMore=false;for(var j=0;j<_headlines.length;j++){this.xDisplay(_headlines[j],"block");} if(_sAllEle){this.xDisplay(_sAllEle,"inline");}} else{this.xHeight(_aEle,"auto");if(this.xDef(_aEle.style.overflowX)){_aEle.style.overflowX="hidden";_aEle.style.overflowY="hidden";} else{_aEle.style.overflow="hidden";} this.xInnerHtml(_lEle,moreToken);_lEle.title=moreToken;_lEle.IsMore=true;for(var j=0;j<_headlines.length;j++){var showHeadline=(j<numHeadlines);(showHeadline)?this.xDisplay(_headlines[j],"block"):this.xDisplay(_headlines[j],"none");} if(_sAllEle){this.xDisplay(_sAllEle,"none");}} if(typeof(_IG_AdjustIFrameHeight)!="undefined"&&typeof(_IG_AdjustIFrameHeight)=="function"){window.setTimeout("_IG_AdjustIFrameHeight()",1);}}}};this.getPagingBar=function(maxHeadlines,itemCount,_literals,bgColor,fontSize,fontColor,fontFamily,tarDivCntrId,_alert){var randomnumber=Math.floor(Math.random()*100001);var t=[];t[t.length]="<div style=\"text-align:center; padding: 5px 0px;\">";t[t.length]="<div id=\"fctv_PagingCntr"+randomnumber+"\" class=\"PagingCntr\" style=\""+"text-align:center;"+";color:"+fontColor+";font-size:"+fontSize+";font-family:"+fontFamily+";font-weight:normal"+"\">";t[t.length]="<a href=\"javascript:void(0)\" style=\"color:"+fontColor+"; text-decoration:none;\" onmouseover=\"FactivaWidgetRenderManager.getInstance().setMouseOver(this);return false;\" onmouseout=\"FactivaWidgetRenderManager.getInstance().setMouseOut(this);return false;\" onclick=\"try{if(FactivaWidgetRenderManager && FactivaWidgetRenderManager.getInstance()) {FactivaWidgetRenderManager.getInstance().getPrevious(this,'"+tarDivCntrId+"',"+maxHeadlines+");return false;}}catch(e){return false;}\" title=\""+_literals.Previous+"\">\u00AB</a>";t[t.length]="<span class=\"pageText\">&nbsp;1-"+maxHeadlines+" of "+itemCount+"&nbsp;</span>";t[t.length]="<a href=\"javascript:void(0)\" style=\"color:"+fontColor+"; text-decoration:none;\" onmouseover=\"FactivaWidgetRenderManager.getInstance().setMouseOver(this);return false;\" onmouseout=\"FactivaWidgetRenderManager.getInstance().setMouseOut(this);return false;\" onclick=\"try{if(FactivaWidgetRenderManager && FactivaWidgetRenderManager.getInstance()) {FactivaWidgetRenderManager.getInstance().getNext(this,'"+tarDivCntrId+"',"+maxHeadlines+");return false;}}catch(e){return false;}\" title=\""+_literals.Next+"\">\u00BB</a>";if(_alert){t[t.length]="<span class=\"fPipe\" style=\"color:#999999\">&nbsp;|&nbsp;</span><a href=\"javascript:void(0)\" style=\"color:"+fontColor+"; text-decoration:none;\" onclick=\"alert(translate('featureIsDisabled'));return false;\" title=\""+_literals.ViewAll+"\" onmouseover=\"FactivaWidgetRenderManager.getInstance().setMouseOver(this);return false;\" onmouseout=\"FactivaWidgetRenderManager.getInstance().setMouseOut(this);return false;\">"+_literals.ViewAll+"</a>";} t[t.length]="</div>";t[t.length]="</div>";return t.join("");};this.moveLeftTab=function(index){var _tDiv=this.xGetElementById("fctv_tabgroup"+index);var _cDiv=this.xGetElementById("fctv_tabgroup_outer"+index);var leftBtn=this.xGetElementById("fctv_tabLeft"+index);var rightBtn=this.xGetElementById("fctv_tabRight"+index);var _tDivRight=_tDiv.offsetLeft+_tDiv.clientWidth;var _cDivRight=_cDiv.clientWidth;var tabs=this.xGetElementsByTagName("a",_tDiv);var carouselStack=[];var rightMostTab;if(_tDiv){if(_tDivRight>_cDivRight){for(var k=0;k<tabs.length;carouselStack.push(tabs[k++].offsetLeft));if(_tDiv.leftCarIndex<=tabs.length-1){var sum=0;for(var j=_tDiv.leftCarIndex+1;j<tabs.length;j++){sum+=tabs[j].clientWidth+1;} if(sum<_cDivRight){_tDiv.edgeDistance=(_tDivRight-_cDivRight);this.xLeft(_tDiv,_tDiv.offsetLeft-_tDiv.edgeDistance);rightBtn.onclick=function(){return false;};rightBtn.style.backgroundColor="#DDDDDD";leftBtn.style.backgroundColor="#FFFFFF";return;} if(_tDiv.edgeDistance==null){this.xLeft(_tDiv,-carouselStack[++_tDiv.leftCarIndex]+1);if(_tDiv.leftCarIndex>0){leftBtn.style.backgroundColor="#FFFFFF";}}}}}};this.moveRightTab=function(index){var _tDiv=this.xGetElementById("fctv_tabgroup"+index);var _cDiv=this.xGetElementById("fctv_tabgroup_outer"+index);var leftBtn=this.xGetElementById("fctv_tabLeft"+index);var rightBtn=this.xGetElementById("fctv_tabRight"+index);var _tDivLeft=_tDiv.offsetLeft;var _cDivLeft=_cDiv.offsetLeft;var tabs=this.xGetElementsByTagName("a",_tDiv);var carouselStack=[];if(_tDiv){if(_tDivLeft<_cDiv.offsetLeft){for(var k=0;k<tabs.length;carouselStack.push(tabs[k++].clientWidth));if(_tDiv.leftCarIndex>=0){if(_tDiv.edgeDistance!=null&&_tDiv.edgeDistance>0){this.xLeft(_tDiv,_tDiv.offsetLeft+_tDiv.edgeDistance);_tDiv.edgeDistance=null;rightBtn.onclick=function(){FactivaWidgetRenderManager.getInstance().moveLeftTab(index);return false;};rightBtn.style.backgroundColor="#FFFFFF";if(_tDiv.leftCarIndex<=0){leftBtn.style.backgroundColor="#DDDDDD";} return;} if(_tDiv.edgeDistance==null){var temp=_tDiv.leftCarIndex-1;if(temp==0)this.xLeft(_tDiv,_tDiv.offsetLeft+carouselStack[--_tDiv.leftCarIndex]+1);else this.xLeft(_tDiv,_tDiv.offsetLeft+carouselStack[--_tDiv.leftCarIndex]+2);if(_tDiv.leftCarIndex<=0){leftBtn.style.backgroundColor="#DDDDDD";}} if(_tDiv.leftCarIndex<0)_tDiv.leftCarIndex=0;}}}};this.setMouseOut=function(ele){this.xGetElementById(ele).style.textDecoration="none";};this.setMouseOver=function(ele){this.xGetElementById(ele).style.textDecoration="underline";};this.RGBToHSL=function(rgb){var min,max,delta,h,s,l;var r=rgb[0],g=rgb[1],b=rgb[2];min=Math.min(r,Math.min(g,b));max=Math.max(r,Math.max(g,b));delta=max-min;l=(min+max)/2;s=0;if(l>0&&l<1){s=delta/(l<0.5?(2*l):(2-2*l));} h=0;if(delta>0){if(max==r&&max!=g)h+=(g-b)/delta;if(max==g&&max!=b)h+=(2+(b-r)/delta);if(max==b&&max!=r)h+=(4+(r-g)/delta);h/=6;} return[h,s,l];};this.unpack=function(color){if(color.length==7){return[parseInt('0x'+color.substring(1,3))/255,parseInt('0x'+color.substring(3,5))/255,parseInt('0x'+color.substring(5,7))/255];}};this.getAlertError=function(folderId,folderName,status,accentColor,fontFamily,fontSize,fontColor,bgColor){switch(status.Code){case 31065:return"";default:return"<div id=\"fctv_AlertTitle\" style=\""+"position:relative;zoom:1"+";background-color:"+accentColor+";padding:3px 5px"+";color:"+fontColor+";font-size:"+fontSize+";font-family:"+fontFamily+";font-weight:bold"+"\">"+((typeof(folderName)=="undefined"||folderName==null)?translate("error"):folderName)+"</div><div id=\"fctv_Error\" style=\""+"background-color:"+bgColor+";padding:3px 5px"+";color:"+fontColor+";font-size:"+fontSize+"\">"+"<div style=\"font-weight:normal;padding:3px 5px\">"+status.Message+"</div></div>";}};this.xBuildAutomaticWidget=function(tEle,result,showTitle){if(result!=null&&result.Definition!=null){var sb=[];}};} return new function(){this.getInstance=function(){if(instance==null){instance=new PrivateConstructor();instance.constructor=null;} return instance;};};})();};function pageLoad(){if(typeof(emg_baseScreen)!="undefined"&&typeof(emg_baseScreen)=="string"){if(emg_baseScreen=="designer"){addDesignerHandlers();initDesigner();} if(emg_baseScreen=="management"){initManagement();}}}
function pageUnload(){if(typeof(emg_baseScreen)!="undefined"&&typeof(emg_baseScreen)=="string"){if(emg_baseScreen=="designer"){removeDesignerHandlers();}}}
function fireMyWidgetDesigner(){hideWidgetList();setAction(1);}function fireMyWidgets(){setAction(2);}
function fireWidgetGallery(){hideWidgetList();setAction(3);}
function setAction(value){var actionInput=$get("at");if(actionInput){actionInput.value=value;var form=getBForm();form.submit();} return;}
function hideWidgetList(){if($get("wPreviewContainer")){$("#wPreviewContainer").css({display:"none",visibility:"hidden"});}}
function ActiveTabChanged(){}
function addDesignerHandlers(){switch(emg_widgetType){case"AlertHeadlineWidget":addDesignerHandlersForAlertHeadlineWidget();break;case"AutomaticWorkspaceWidget":addDesignerHandlersForAutomaticWorkspaceWidget();break;case"ManualNewsletterWorkspaceWidget":addDesignerHandlersForManualNewsletterWorkspaceWidget();break;}}
function removeDesignerHandlers(){switch(emg_widgetType){case"AlertHeadlineWidget":removeDesignerHandlersForAlertHeadlineWidget();break;case"AutomaticWorkspaceWidget":removeDesignerHandlersForAutomaticWorkspaceWidget();break;case"ManualNewsletterWorkspaceWidget":removeDesignerHandlersForManualNewsletterWorkspaceWidget();break;}}
function initManagement(){var tContainer=$find("wTabContainer");var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.set_Y(100);modalPopupBehavior.show();$get("mPopHeader").innerHTML=translate("widgetManagement");CommonToolkitScripts.setVisible($get("codeLoadingCntr"),true);CommonToolkitScripts.setVisible($get("codeUpdatingCntr"),false);CommonToolkitScripts.setVisible($get("codeCntr"),false);CommonToolkitScripts.setVisible($get("divBase"),false);fireInitialSort(true);}
function removeManagement(){}
function onColorPickerUpdate(){switch(emg_widgetType){case"AlertHeadlineWidget":window.setTimeout("updateAlertHeadlineWidgetPreview()",1);break;case"AutomaticWorkspaceWidget":window.setTimeout("updateAutomaticWorkspaceWidgetPreview()",1);break;case"ManualNewsletterWorkspaceWidget":window.setTimeout("updateManualNewsletterWorkspaceWidgetPreview()",1);break;}}
function updateProxyCredAuthScheme(leavePasswordValue){switch(cInt(getAuthScheme())){case 0:CommonToolkitScripts.setVisible($get("proxyCredEmailAddressRow"),false);CommonToolkitScripts.setVisible($get("proxyCredUserIdRow"),true);CommonToolkitScripts.setVisible($get("proxyCredNamespaceRow"),true);break;default:CommonToolkitScripts.setVisible($get("proxyCredEmailAddressRow"),true);CommonToolkitScripts.setVisible($get("proxyCredUserIdRow"),false);CommonToolkitScripts.setVisible($get("proxyCredNamespaceRow"),false);break;} if(!leavePasswordValue){$get("proxyCredPassword").value="";}}
function updateProxyCredAuthSchemeHandler(){updateProxyCredAuthScheme(false);}
function fireInitialSort(doNotShowLoading){var extender=$find('wPreviewExtender');if(extender._widgets.length<=1&&extender._addedWidgets)return;if(!doNotShowLoading)extender.showLoadingArea();extender.removeAllWidgets();EMG.widgets.services.WidgetDesignerManager.GetWidgetList(EMG.widgets.ui.dto.WidgetSortBy.Date,accessPointCode,interfaceLanguage,sa_from,initManagement_success,generic_failure,$find('wPreviewExtender'));}
function initDesigner(){switch(emg_widgetType){case"AlertHeadlineWidget":initDesignerForAlertHeadlineWidget();break;case"AutomaticWorkspaceWidget":initDesignerForAutomaticWorkspaceWidget();break;case"ManualNewsletterWorkspaceWidget":initDesignerForManualNewsletterWorkspaceWidget();break;}}
function getAudience(){var tForm=getBForm();var audienceList=tForm.elements["audience"];for(var i=0;i<audienceList.length;i++){if(audienceList[i].checked){return cInt(audienceList[i].value);}} return"0";}
function getAuthScheme(){var tForm=getBForm();var authSchemeList=tForm.elements["authScheme"];for(var i=0;i<authSchemeList.length;i++){if(authSchemeList[i].checked){return authSchemeList[i].value;}} return"0";}
function hideModalPopupViaClient(){var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.hide();}
function showFrameworkError(result){var message="-1: Framework Error.";if(result!=null&&result.ReturnCode!=0){var _errorCode=cInt(result.ReturnCode);switch(_errorCode){case-2147176633:case-2147183530:sessTimeOut();return;break;default:message=result.ReturnCode+": "+result.StatusMessage;break;} message=result.ReturnCode+": "+result.StatusMessage;} showError(message);return;}
function sessTimeOut(){var returnUrlInput=$get("returnurl");if(returnUrlInput){var returnUrlValue=cStr(returnUrlInput.value).trim();if(returnUrlValue!=null&&returnUrlValue.length>0){window.location.href=returnUrlValue;}}}
function updateBadgets(result){if(typeof(result)=='undefined'||result==null){return;} if(typeof(result.IntegrationEndPoints)=='undefined'||result.IntegrationEndPoints==null||result.IntegrationEndPoints.length==0){return;} var _badge_sb=new Sys.StringBuilder();for(var i=0;i<result.IntegrationEndPoints.length;i++){var IEndPoint=result.IntegrationEndPoints[i];_badge_sb.append("<div class=\"iBadge\">");_badge_sb.append("<a href=\""+IEndPoint.IntegrationUrl+"\" onclick=\"xWinOpen(this.href);return false;\" title=\""+translate("integrate")+"\">");if(IEndPoint.HasIcon)_badge_sb.append("<img class=\"iIcon\" src=\""+IEndPoint.Icon+"\"/>");_badge_sb.append("<span class=\"iBadge\">"+IEndPoint.Title+"</span>");_badge_sb.append("</a>");_badge_sb.append("</div>");} $get("publishingContainer").innerHTML=_badge_sb.toString();}
function updateAccordionPanes(result){if(typeof(result)=='undefined'||result==null){return;} if(typeof(result.IntegrationEndPoints)=='undefined'||result.IntegrationEndPoints==null||result.IntegrationEndPoints.length==0){return;} for(var i=0;i<result.IntegrationEndPoints.length;i++){var IEndPoint=result.IntegrationEndPoints[i];var _header_sb=new Sys.StringBuilder();var _content_sb=new Sys.StringBuilder();_header_sb.append("<div class=\"hBadge\">");if(IEndPoint.HasIcon)_header_sb.append("<img class=\"bIcon\" src=\""+IEndPoint.Icon+"\"/>");_header_sb.append("<span class=\"bTitle\">"+IEndPoint.Title+"</span>");_header_sb.append("</div>");_content_sb.append("<div class=\"bContents\">");_content_sb.append("<div class=\"bInstructions\">");_content_sb.append(translate("getPortalWidgetIntructions"));_content_sb.append("</div>");_content_sb.append("<div class=\"bLink\">");_content_sb.append("<a href=\""+IEndPoint.IntegrationUrl+"\" onclick=\"xWinOpen(this.href);return false;\"><span class=\"iBadge\" title=\""+translate("integrate")+"\">"+IEndPoint.Title+"</span></a>");_content_sb.append("</div>");_content_sb.append("<div class=\"bInstructions\">");_content_sb.append(translate("getUrlToPortalWidgetIntructions"));_content_sb.append("</div>");_content_sb.append("<div class=\"bLink\">");_content_sb.append("<input name=\"integration_"+i+"\" style=\"width:90%\" value=\""+IEndPoint.IntegrationUrl+"\" />");_content_sb.append("</div>");_content_sb.append("</div>");addPane(_header_sb.toString(),_content_sb.toString());}}
function removeAccordionPanes(){var behavior=$find('codeAccordion_AccordionExtender');if(behavior){var root=behavior.get_element();behavior.dispose();if(typeof(root)=='undefined'||root==null){return;} var len=root.childNodes.length;for(var i=len-1;i>=2;i--){xRemoveChild(root,root.childNodes[i]);} $create(AjaxControlToolkit.AccordionBehavior,{"ClientStateFieldID":"codeAccordion_AccordionExtender_ClientState","ContentCssClass":"accordionContent","FadeTransitions":true,"FramesPerSecond":40,"HeaderCssClass":"accordionHeader","SelectedIndex":-1,"id":"codeAccordion_AccordionExtender","requireOpenedPane":false,"suppressHeaderPostbacks":true},null,null,$get("codeAccordion"));}}
function removeWidgetItems(){var behavior=$find('wPreviewExtender');if(behavior){var root=behavior.get_element();behavior.dispose();if(typeof(root)=='undefined'||root==null){return;} var len=root.childNodes.length;for(var i=len-1;i>=2;i--){xRemoveChild(root,root.childNodes[i]);}}}
function updateWidgetContentItems(result){if(typeof(result)=='undefined'||result==null){return;} if(typeof(result.Widgets)=='undefined'||result.Widgets==null||result.Widgets.length==0){return;} for(var i=0;i<result.Widgets.length;i++){}}
function addWidgetItem(widgetDelegate){var behavior=$find('wPreviewExtender');if(behavior){var root=behavior.get_element();behavior.addWidget(widgetDelegate);}}
function addWidgets(widgetDelegate){var behavior=$find("wPreviewExtender");if(behavior){var root=behavior.get_element();behavior.addWidgets(widgetDelegate);}}
function addPane(headerHTML,contentHTML){var behavior=$find('codeAccordion_AccordionExtender');if(behavior){var root=behavior.get_element();var header=document.createElement("div");header.className="accordionHeader";header.innerHTML=headerHTML;var paneContent=document.createElement("div");paneContent.className="accordionContent";paneContent.innerHTML=contentHTML;root.appendChild(header);root.appendChild(paneContent);behavior.addPane(header,paneContent);}}
function showError(message){var modalPopupBehavior=$find('programmaticModalPopupBehavior');var modalErrorPopupBehavior=$find('programmaticErrorModalPopupBehavior');modalPopupBehavior.hide();modalErrorPopupBehavior.hide();var errorMessageDiv=$get("errorMsg");var errorLabel=$get('errorLbl');errorLabel.innerHTML=translate("error");errorMessageDiv.innerHTML=message;modalErrorPopupBehavior.set_Y(100);modalErrorPopupBehavior.show();}
function showWarning(message){var modalPopupBehavior=$find('programmaticErrorModalPopupBehavior');modalPopupBehavior.hide();var errorMessageDiv=$get("errorMsg");var errorLabel=$get('errorLbl');errorLabel.innerHTML=translate("warning");errorMessageDiv.innerHTML=message;modalPopupBehavior.set_Y(100);modalPopupBehavior.show();}
function showPreview(result,userContext){var modalPopupBehavior=$find('programmaticErrorModalPopupBehavior');modalPopupBehavior.hide();var errorMessageDiv=$get("errorMsg");var errorLabel=$get('errorLbl');errorLabel.innerHTML=translate("preview");FactivaWidgetRenderManager.getInstance().xBuildAlertWidget(errorMessageDiv,result,true);modalPopupBehavior.set_Y(100);modalPopupBehavior.show();}
function showMessage(message){var modalPopupBehavior=$find('programmaticErrorModalPopupBehavior');modalPopupBehavior.hide();var errorMessageDiv=$get("errorMsg");var errorLabel=$get('errorLbl');errorLabel.innerHTML=translate("message");errorMessageDiv.innerHTML=message;modalPopupBehavior.set_Y(100);modalPopupBehavior.show();}
function showMovie(){var _modalPopupBehavior=$find('programmaticMovieModalPopupBehavior');var _movieMessageDiv=$get("movieContainer");if(typeof(FlashObject)!='undefined'&&movieData){var fo=new FlashObject(movieData.source,"temp_swf",movieData.width,movieData.height,movieData.targetFlashPlayerVersion);fo.write(_movieMessageDiv);} _modalPopupBehavior.set_Y(10);_modalPopupBehavior.show();}
function showAutoMovie(){if(arguments.callee.done)return;arguments.callee.done=true;showMovie();}var extender=null;function updateWidgetsViewPreview(result,userContext){var wDelegate=userContext.eventArgs.get_WidgetDelegate();var parent=$get("appendAJAX");var previewPopupContainer=document.createElement("div");previewPopupContainer.id="preview_popup_container";Sys.UI.DomElement.addCssClass(previewPopupContainer,"ajax__widget_preview_popup_container");var previewPopupContent=document.createElement("div");previewPopupContent.id="preview_popup_content";Sys.UI.DomElement.addCssClass(previewPopupContent,"ajax__widget_preview_popup_content");var previewPopupHeader=document.createElement("div");Sys.UI.DomElement.addCssClass(previewPopupHeader,"ajax__widget_preview_popup_header");var previewPopupHeaderText=document.createElement("span");Sys.UI.DomElement.addCssClass(previewPopupHeaderText,"ajax__widget_preview_popup_header_text");previewPopupHeaderText.innerHTML="Widget Preview";var previewPopupClose=document.createElement("div");Sys.UI.DomElement.addCssClass(previewPopupClose,"ajax__widget_preview_popup_close");previewPopupClose.href="javascript:void(0)";previewPopupClose.innerHTML="<a>X Close</a>";$addHandler(previewPopupClose,"click",hidePreviewPopup);previewPopupHeader.appendChild(previewPopupHeaderText);previewPopupHeader.appendChild(previewPopupClose);previewPopupContainer.appendChild(previewPopupHeader);previewPopupContainer.appendChild(previewPopupContent);parent.appendChild(previewPopupContainer);extender=$create(AjaxControlToolkit.PopupBehavior,{"parentElement":parent,"positioningMode":0,"x":405,"y":60,"id":"previewPopupBehavior"},null,null,previewPopupContainer);extender.show();switch(wDelegate.Type){case 0:FactivaWidgetRenderManager.getInstance().xBuildAlertWidget(previewPopupContent,result,true);break;case 1:FactivaWidgetRenderManager.getInstance().xBuildAutomaticWorkspaceWidget(previewPopupContent,result,true);break;case 2:FactivaWidgetRenderManager.getInstance().xBuildManualNewsletterWorkspaceWidget(previewPopupContent,result,true);break;}}
function hidePreviewPopup(){extender.hide();extender.dispose();$("select").css({visibility:"visible"});$(".ajax__widget_preview_popup_container").remove();}
function loadScriptCode(url,tElement){var script=document.createElement('script');script.src=url;script.type="text/javascript";script.charset="utf-8";if(tElement){tElement.appendChild(script);}}
function generic_failure(error,userContext,methodName){showFrameworkError();}
function initManagement_success(result,userContext,methodName){var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.hide();if(result!=null&&result.ReturnCode!=0){showFrameworkError(result);} else if(result!=null&&result.ReturnCode==0){updateWidgets(result,userContext);if(result.Widgets!=null&&result.Widgets.length>0){renderTableSorter();}} else{showFrameworkError();}}
function removeWidgets(){}
function renderTableSorter(){var behavior=$find("wPreviewExtender");$create(EMG.Toolkit.Web.TableSorterBehavior,{"headers":"{3:{sorter:false}}","sortList":($get("sortOrder").value!=null)?$get("sortOrder").value:"[[2,1]]","widthFixed":true,"debug":false,"id":"tableSorterBehavior"},null,null,$get("widgetListTable"));$create(EMG.Toolkit.Web.TableSorterFilterBehavior,{"filterContainer":"searchTextInputCtrl","filterClearContainer":"clearSearchCtrl","filterColumns":"[0]","filterCaseSensitive":false,"id":"tableSorterFilterBehavior"},null,null,$get("widgetListTable"));$create(EMG.Toolkit.Web.TableSorterPagingBehavior,{"firstImage":behavior.get_firstImage(),"lastImage":behavior.get_lastImage(),"nextImage":behavior.get_nextImage(),"prevImage":behavior.get_prevImage(),"firstToken":behavior.get_firstToken(),"lastToken":behavior.get_lastToken(),"nextToken":behavior.get_nextToken(),"previousToken":behavior.get_previousToken(),"resultsPerPageToken":behavior.get_resultsPerPageToken(),"size":($get("pagesize").value!=null)?parseInt($get("pagesize").value):20,"page":($get("page").value!=null)?parseInt($get("page").value):0,"id":"tableSorterPagingBehavior"},null,null,$get("widgetListTable"));$addHandler($get("typeFilterCtrl"),"change",fireTypeFilter);$addHandler($get("clearSearchCtrl"),"click",clearTypeFilter);$(".pagesize").change(function(){updatePageSlashPageSizeHiddenInput();});$(".first").click(function(){updatePageSlashPageSizeHiddenInput();});$(".prev").click(function(){updatePageSlashPageSizeHiddenInput();});$(".next").click(function(){updatePageSlashPageSizeHiddenInput();});$(".last").click(function(){updatePageSlashPageSizeHiddenInput();});$("th").click(function(){updateSortOrder();});var timer;$("#searchTextInputCtrl").keyup(function(){$get("typeFilterCtrl").selectedIndex=0;clearTimeout(timer);timer=setTimeout(searchCallback,1005);return false;});$("#typeFilterCtrl").change(function(){$get("searchTextInputCtrl").value="";clearTimeout(timer);timer=setTimeout(searchCallback,1);});$("#searchButtonCtrl").click(function(){var filterText=$get("searchTextInputCtrl").value;$("#widgetListTable").trigger("invokeFilter",[filterText]);clearTimeout(timer);timer=setTimeout(searchCallback,1);});}
function disposeTableSorter(){$find("tableSorterPagingBehavior").dispose();$find("tableSorterFilterBehavior").dispose();$find("tableSorterBehavior").dispose();$removeHandler($get("typeFilterCtrl"),"change",fireTypeFilter);$removeHandler($get("clearSearchCtrl"),"click",clearTypeFilter);$(".pagesize").unbind();$(".first").unbind();$(".prev").unbind();$(".next").unbind();$(".last").unbind();$("th").unbind();$("#searchButtonCtrl").unbind();}
function fireTypeFilter(e){var filterIndex=$get("typeFilterCtrl").selectedIndex;var filterText=$get("typeFilterCtrl").options[filterIndex].value;$("#widgetListTable").trigger("invokeColumnFilter",[filterText,[1]]);}
function clearTypeFilter(e){var filterIndex=$get("typeFilterCtrl").selectedIndex=0;$("#pager").css({display:"block",visibility:"visible"});$(".ajax__widget_noWidgets").css({display:"none",visibility:"hidden"});}
function updatePageSlashPageSizeHiddenInput(){var value=$(".pagesize").selectedOptions()[0].value;var config=$("#widgetListTable").trigger("getConfig")[0].config;$get("pagesize").value=value;$get("page").value=config.page;}
function updateSortOrder(){var config=$("#widgetListTable").trigger("getConfig")[0].config;var arraySortOrder=config.sortList;var stringSortOrder="";for(var i=arraySortOrder.length-1;i>=0;i--){if(i>0)stringSortOrder+="["+cStr(arraySortOrder[i])+"],";else stringSortOrder+="["+cStr(arraySortOrder[i])+"]";} $get("sortOrder").value="["+stringSortOrder+"]";}
function searchCallback(){var table=$get("widgetListTable");if(table.rows.length<=1){$("#pager").css({display:"none",visibility:"hidden"});$(".ajax__widget_noWidgets").css({display:"block",visibility:"visible"});} else{$("#pager").css({display:"block",visibility:"visible"});$(".ajax__widget_noWidgets").css({display:"none",visibility:"hidden"});}}
function hideSearchControls(){$(".searchTextCtrlContainer").css({display:"block",visibility:"hidden"});$(".typeFilterCtrlContainer").css({display:"block",visibility:"hidden"});}
function validateColor(value,defaultColor){var temp=trim(cStr(value));if(/^#[a-f0-9]{6}$/i.test(value)){return temp;} return defaultColor;}
function updateWidgets(result,userContext){if(typeof(result)=='undefined'||result==null){return;} if(typeof(result.Widgets)=='undefined'||result.Widgets==null||result.Widgets.length==0){var tContainer=$find("wTabContainer");var widgetIdInput=$get("wid");if(tContainer&&widgetIdInput&&(widgetIdInput.value!=null&&widgetIdInput.value.length>0)){tContainer.getFirstTab()._hide();} hideSearchControls();userContext.showNoWidgetsArea();showAutoMovie();return;} userContext.removeAllWidgets();if(result.Widgets.length>0){addWidgets(result.Widgets);}}
function createWidget_success(result,userContext,methodName){if(result!=null&&result.ReturnCode!=0){showFrameworkError(result);} else if(result!=null&&result.ReturnCode==0){$get("wdgtUpdateCntrl").style.display="block";$get("wdgtCodeGenCntrl").style.display="block";$get("wdgtCreateCntrl").style.display="none";var wIdHiddenInput=$get("wid");if(wIdHiddenInput){wIdHiddenInput.value=result.WidgetId;} var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.hide();return;} else{showFrameworkError();} CommonToolkitScripts.setVisible($get("wdgtCreateCntrl"),true);CommonToolkitScripts.setVisible($get("wdgtUpdateCntrl"),false);CommonToolkitScripts.setVisible($get("wdgtCodeGenCntrl"),false);return;}
function updateWidget_success(result,userContext,methodName){if(result!=null&&result.ReturnCode!=0){showFrameworkError(result);} else if(result!=null&&result.ReturnCode==0){var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.hide();} else{showFrameworkError();} CommonToolkitScripts.setVisible($get("wdgtCreateCntrl"),false);CommonToolkitScripts.setVisible($get("wdgtUpdateCntrl"),true);CommonToolkitScripts.setVisible($get("wdgtCodeGenCntrl"),true);return;}
function getPreview_success(result,userContext,methodName){if(result!=null&&result.ReturnCode!=0){showFrameworkError(result);userContext.sender.showContentArea();} else if(result!=null&&result.ReturnCode==0){updateWidgetsViewPreview(result,userContext);var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.hide();$("select").css({visibility:"hidden"});return;} else{showFrameworkError();}}
function getScriptCode_success(result,userContext,methodName){if(result!=null&&result.ReturnCode!=0){showFrameworkError(result);} else if(result!=null&&result.ReturnCode==0){var modalPopupBehavior=$find('programmaticModalPopupBehavior');var txtArea=$get("scriptCode");var pubArea=$get("publishingContainer");$get("mPopHeader").innerHTML=translate("displayCode");CommonToolkitScripts.setVisible($get("codeLoadingCntr"),false);CommonToolkitScripts.setVisible($get("codeUpdatingCntr"),false);CommonToolkitScripts.setVisible($get("codeCntr"),true);CommonToolkitScripts.setVisible($get("divBase"),true);if(txtArea){txtArea.value=result.JavaSciptWidgetCodeSnippet;addSecurityToTextArea();var behavior=$find('codeAccordion_AccordionExtender');if(behavior){removeAccordionPanes();updateAccordionPanes(result);} else{updateBadgets(result);} txtArea.select();} if($get("http")&&$get("https")){$addHandler($get("http"),'click',addSecurityToTextArea);$addHandler($get("https"),'click',addSecurityToTextArea);}} else{showFrameworkError();}}
var BASELINE_ERROR=520400;var NO_VALID_FOLDERS=BASELINE_ERROR+10;var SHARE_PROPERTIES_ON_FOLDER_SET_TO_DENEY=BASELINE_ERROR+11;var HAS_
function initDesigner_success(result,userContext,methodName){switch(emg_widgetType){case"AlertHeadlineWidget":initDesignerSuccessForAlertHeadlineWidget(result,userContext,methodName);break;case"AutomaticWorkspaceWidget":initDesignerSuccessForAutomaticWorkspaceWidget(result,userContext,methodName);break;case"ManualNewsletterWorkspaceWidget":initDesignerSuccessForManualNewsletterWorkspaceWidget(result,userContext,methodName);break;}}
function setExternalReaderAudience(){var targetAudience=$get("audience_3");targetAudience.checked=true;}
function clientSideValidation(){if(delegate.name!=null&&delegate.name.length>0){} return false;}
function getUpdatePopup(){if(!FactivaWidgetRenderManager.getInstance().getInitialized()){showError(translate("applicationInitializationError"));return;} switch(emg_widgetType){case"AlertHeadlineWidget":fireUpdateAlertHeadlineWidget();break;case"AutomaticWorkspaceWidget":fireUpdateAutomaticWorkspaceHeadlineWidget();break;case"ManualNewsletterWorkspaceWidget":fireUpdateManualNewsletterWorkspaceHeadlineWidget();break;} return;}
function getCreatePopup(){if(!FactivaWidgetRenderManager.getInstance().getInitialized()){showError(translate("applicationInitializationError"));return;} switch(emg_widgetType){case"AlertHeadlineWidget":console.log("getCreatePopup>>AlertHeadlineWidget");fireCreateAlertHeadlineWidget();break;case"AutomaticWorkspaceWidget":console.log("getCreatePopup>>AutomaticWorkspaceWidget");fireCreateAutomaticWorkspaceHeadlineWidget();break;case"ManualNewsletterWorkspaceWidget":console.log("getCreatePopup>>ManualNewsletterWorkspaceWidget");fireCreateManualNewsletterWorkspaceHeadlineWidget();break;} return;}
function getProxyCredentialsPopup(errorMessage){if(!FactivaWidgetRenderManager.getInstance().getInitialized()){showError(translate("applicationInitializationError"));return;} var targetAudience=$get("audience_2");if(targetAudience){targetAudience.checked=true;} if(errorMessage&&errorMessage.length>0){CommonToolkitScripts.setVisible($get("proxyCredErrorMsg"),true);$get("proxyCredErrorMsg").innerHTML=errorMessage;} else{CommonToolkitScripts.setVisible($get("proxyCredErrorMsg"),false);} var wIdInput=$get("wid");var _wId=trim(cStr(wIdInput.value));if(_wId.length>0){CommonToolkitScripts.setVisible($get("proxyCredLnkClose"),true);} else{CommonToolkitScripts.setVisible($get("proxyCredLnkClose"),false);} var modalPopupBehavior=$find('proxyCredModalPopupBehavior');modalPopupBehavior.set_Y(100);modalPopupBehavior.show();}
function okProxyUpdate(){var modalPopupBehavior=$find('proxyConfirmModalPopupBehavior');modalPopupBehavior.hide();var wIdInput=$get("wid");var _wId=trim(cStr(wIdInput.value));if(_wId.length>0){getUpdatePopup();} else{getCreatePopup();}}
function closeProxyUpdate(){var modalPopupBehavior=$find('proxyConfirmModalPopupBehavior');modalPopupBehavior.hide();}
function okUpdate(){var modalPopupBehavior=$find('proxyConfirmModalPopupBehavior');modalPopupBehavior.hide();switch(emg_widgetType){case"AlertHeadlineWidget":fireUpdateAlertHeadlineWidgetScriptCode();break;case"AutomaticWorkspaceWidget":fireUpdateAutomaticWorkspaceWidgetAndGetScriptCode();break;case"ManualNewsletterWorkspaceWidget":fireUpdateManualNewsletterWorkspaceWidgetAndGetScriptCode();break;}}
function closeUpdate(){var modalPopupBehavior=$find('proxyConfirmModalPopupBehavior');modalPopupBehavior.hide();var wIdHiddenInput=$get("wid");if(wIdHiddenInput){$get("mPopHeader").innerHTML=translate("displayCode");CommonToolkitScripts.setVisible($get("codeLoadingCntr"),true);CommonToolkitScripts.setVisible($get("codeUpdatingCntr"),false);CommonToolkitScripts.setVisible($get("codeCntr"),false);CommonToolkitScripts.setVisible($get("divBase"),false);var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.set_Y(100);modalPopupBehavior.show();EMG.widgets.services.WidgetDesignerManager.GetWidgetScriptCode(wIdHiddenInput.value,accessPointCode,interfaceLanguage,sa_from,getScriptCode_success,generic_failure,null);return;} showError(translate("noWidgetIdFound"));}
function closeProxyCredModal(){var modalPopupBehavior=$find('proxyCredModalPopupBehavior');modalPopupBehavior.hide();}
function openUpdateWidgetModal(){var modalPopupBehavior=$find('proxyCredModalPopupBehavior');modalPopupBehavior.hide();var delegate=new EMG.widgets.ui.delegates.input.UpdateAlertHeadlineWidgetDelegate();var result=FactivaWidgetRenderManager.getInstance().getData();var wIdInput=$get("wid");var _wId=trim(cStr(wIdInput.value));if(_wId.length>0){if(!fillAlertHeadlineWidgetDelegate(delegate,result,true)){return false;}} else{return false;} var modalPopupBehavior=$find('proxyConfirmModalPopupBehavior');modalPopupBehavior.set_Y(100);modalPopupBehavior.show();CommonToolkitScripts.setVisible($get("publishConfirmControl"),false);CommonToolkitScripts.setVisible($get("proxyConfirmControl"),true);}
function getCodeGenerationPopup(){if(!FactivaWidgetRenderManager.getInstance().getInitialized()){showError(translate("applicationInitializationError"));return;} var modalPopupBehavior=$find('proxyConfirmModalPopupBehavior');modalPopupBehavior.set_Y(100);modalPopupBehavior.show();CommonToolkitScripts.setVisible($get("publishConfirmControl"),true);CommonToolkitScripts.setVisible($get("proxyConfirmControl"),false);}function onWidgetEdit(sender,eventArgs){var wDelegate=eventArgs.get_WidgetDelegate();if(wDelegate){var actionInput=$get("at");var widgetIdInput=$get("wid");if(actionInput&&widgetIdInput){hideWidgetList();actionInput.value=1;widgetIdInput.value=wDelegate.Id;var tForm=document.forms['PageBaseForm'];tForm.submit();}} return false;}
var tempArgs=null;function onWidgetDelete(sender,eventArgs){var confirmDeletePopupBehavior=$find('modalConfirmDeleteButtonBehavior');tempArgs={"sender":sender,"eventArgs":eventArgs};confirmDeletePopupBehavior.set_Y(100);confirmDeletePopupBehavior.show();return false;}
function confirmDeletePopupOK(){var confirmDeletePopupBehavior=$find('modalConfirmDeleteButtonBehavior');confirmDeletePopupBehavior.hide();$get("mPopHeader").innerHTML=translate("delete");CommonToolkitScripts.setVisible($get("codeLoadingCntr"),false);CommonToolkitScripts.setVisible($get("codeUpdatingCntr"),true);CommonToolkitScripts.setVisible($get("codeCntr"),false);CommonToolkitScripts.setVisible($get("divBase"),false);var wDelegate=tempArgs.eventArgs.get_WidgetDelegate();var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.set_Y(100);modalPopupBehavior.show();if(wDelegate){EMG.widgets.services.WidgetDesignerManager.DeleteWidget(wDelegate.Id,accessPointCode,interfaceLanguage,sa_from,deleteManager_success,generic_failure,tempArgs);} tempArgs=null;return false;}
function deleteManager_success(result,userContext,methodName){var sender=userContext.sender;var wDelegate=userContext.eventArgs.get_WidgetDelegate();if(result!=null&&result.ReturnCode!=0){showFrameworkError(result);} else if(result!=null&&result.ReturnCode==0){sender.removeWidgetById(wDelegate.Id);var tContainer=$find("wTabContainer");var widgetIdInput=$get("wid");if($get("widgetListTable")!=null&&$get("widgetListTable").tBodies[0].rows.length>0){var copyConfig=$("#widgetListTable").trigger("getConfig");size=copyConfig[0].config.size;disposeTableSorter();} if($get("widgetListTable")!=null&&$get("widgetListTable").tBodies[0].rows.length>0){renderTableSorter();} if(tContainer&&widgetIdInput&&(widgetIdInput.value==wDelegate.Id)){tContainer.getFirstTab()._hide();widgetIdInput.value="";} if(sender._widgets==null||sender._widgets.length==0){sender.showNoWidgetsArea();hideSearchControls();showAutoMovie();} var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.hide();} else{showFrameworkError();}}
function onWidgetPublish(sender,eventArgs){var wDelegate=eventArgs.get_WidgetDelegate();if(wDelegate){$get("mPopHeader").innerHTML=translate("displayCode");CommonToolkitScripts.setVisible($get("codeLoadingCntr"),true);CommonToolkitScripts.setVisible($get("codeUpdatingCntr"),false);CommonToolkitScripts.setVisible($get("codeCntr"),false);CommonToolkitScripts.setVisible($get("divBase"),false);var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.set_Y(100);modalPopupBehavior.show();EMG.widgets.services.WidgetDesignerManager.GetWidgetScriptCode(wDelegate.Id,accessPointCode,interfaceLanguage,sa_from,getScriptCode_success,generic_failure,{"sender":sender,"eventArgs":eventArgs});return;} return false;}
function onWidgetPreview(sender,eventArgs){var wDelegate=eventArgs.get_WidgetDelegate();CommonToolkitScripts.setVisible($get("sortWidgetsByCntr"),false);$get("mPopHeader").innerHTML=translate("preview");CommonToolkitScripts.setVisible($get("codeLoadingCntr"),true);CommonToolkitScripts.setVisible($get("codeUpdatingCntr"),false);CommonToolkitScripts.setVisible($get("codeCntr"),false);CommonToolkitScripts.setVisible($get("divBase"),false);var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.set_Y(100);modalPopupBehavior.show();switch(wDelegate.Type){case 0:EMG.widgets.services.WidgetDesignerManager.GetAlertHeadlineWidget(wDelegate.Id,accessPointCode,interfaceLanguage,sa_from,getPreview_success,generic_failure,{"sender":sender,"eventArgs":eventArgs});break;case 1:EMG.widgets.services.WidgetDesignerManager.GetAutomaticWorkspaceWidget(wDelegate.Id,accessPointCode,interfaceLanguage,sa_from,getPreview_success,generic_failure,{"sender":sender,"eventArgs":eventArgs});break;case 2:EMG.widgets.services.WidgetDesignerManager.GetManualNewsletterWorkspaceWidget(wDelegate.Id,accessPointCode,interfaceLanguage,sa_from,getPreview_success,generic_failure,{"sender":sender,"eventArgs":eventArgs});break;break;} return false;}
function onPreviewBack(sender,eventargs){CommonToolkitScripts.setVisible($get("sortWidgetsByCntr"),true);sender.showContentArea();}
function closeMovieModal(){$find('programmaticMovieModalPopupBehavior').hide();}
function closeErrorModal(){document.body.style.height="auto";$find('programmaticErrorModalPopupBehavior').hide();}
function closeModal(){$find('programmaticModalPopupBehavior').hide();}
function closeProxyModal(){$find('proxyCredModalPopupBehavior').hide();}
function addSecurityToTextArea(){var txtArea=$get("scriptCode");var http=$get("http");var https=$get("https");if(txtArea&&http&&https){if(http.checked==true){if((txtArea.value).substring(13,19)=="https:"){txtArea.value=(txtArea.value).replace("https:","http:");return;}} if(https.checked==true){if((txtArea.value).substring(13,18)=="http:"){txtArea.value=(txtArea.value).replace("http:","https:");return;}}}}
function addDesignerHandlersForAlertHeadlineWidget(){$addHandler($get("wName"),"blur",updateAlertHeadlineWidgetPreview);$addHandler($get("mainColor_input"),"blur",updateAlertHeadlineWidgetPreview);$addHandler($get("mainFontColor_input"),"blur",updateAlertHeadlineWidgetPreview);$addHandler($get("accentColor_input"),"blur",updateAlertHeadlineWidgetPreview);$addHandler($get("accentFontColor_input"),"blur",updateAlertHeadlineWidgetPreview);$addHandler($get("chartBarColor_input"),"blur",updateAlertHeadlineWidgetPreview);$addHandler($get("fFmly"),"change",updateAlertHeadlineWidgetPreview);$addHandler($get("fSize"),"change",updateAlertHeadlineWidgetPreview);$addHandler($get("numHdlnes"),"change",updateAlertHeadlineWidgetPreview);$addHandler($get("selTemp"),"change",updateTemplateColorsForAlertPreview);$addHandler($get("hdlnDspl_0"),"click",updateAlertHeadlineWidgetPreview);$addHandler($get("hdlnDspl_1"),"click",updateAlertHeadlineWidgetPreview);if($get("audience_0"))$addHandler($get("audience_0"),"click",updateAlertHeadlineWidgetPreview);if($get("audience_1"))$addHandler($get("audience_1"),"click",updateAlertHeadlineWidgetPreview);if($get("audience_2"))$addHandler($get("audience_2"),"click",updateAlertHeadlineWidgetPreview);if($get("audience_3"))$addHandler($get("audience_3"),"click",updateAlertHeadlineWidgetPreview);if($get("proxyCredUserId")){$addHandler($get("authScheme_0"),"click",updateProxyCredAuthSchemeHandler);$addHandler($get("authScheme_1"),"click",updateProxyCredAuthSchemeHandler);} if($get("http")&&$get("https")){$addHandler($get("http"),'click',addSecurityToTextArea);$addHandler($get("https"),'click',addSecurityToTextArea);}}
function fireCreateAlertHeadlineWidget(){var delegate=new EMG.widgets.ui.delegates.input.CreateAlertHeadlineWidgetDelegate();var result=FactivaWidgetRenderManager.getInstance().getData();if(fillAlertHeadlineWidgetDelegate(delegate,result)){$get("mPopHeader").innerHTML=translate("saveWidgetDesignNow");CommonToolkitScripts.setVisible($get("codeLoadingCntr"),false);CommonToolkitScripts.setVisible($get("codeUpdatingCntr"),true);CommonToolkitScripts.setVisible($get("codeCntr"),false);CommonToolkitScripts.setVisible($get("divBase"),false);var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.set_Y(100);modalPopupBehavior.show();EMG.widgets.services.WidgetDesignerManager.CreateAlertHeadlineWidget(delegate,accessPointCode,interfaceLanguage,sa_from,createWidget_success,generic_failure,null);} return;}
function fireUpdateAlertHeadlineWidget(){var delegate=new EMG.widgets.ui.delegates.input.UpdateAlertHeadlineWidgetDelegate();var result=FactivaWidgetRenderManager.getInstance().getData();if(fillAlertHeadlineWidgetDelegate(delegate,result,true)){$get("mPopHeader").innerHTML=translate("updateWidgetDesign");CommonToolkitScripts.setVisible($get("codeLoadingCntr"),false);CommonToolkitScripts.setVisible($get("codeUpdatingCntr"),true);CommonToolkitScripts.setVisible($get("codeCntr"),false);CommonToolkitScripts.setVisible($get("divBase"),false);var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.set_Y(100);modalPopupBehavior.show();EMG.widgets.services.WidgetDesignerManager.UpdateAlertHeadlineWidget(delegate,accessPointCode,interfaceLanguage,sa_from,updateWidget_success,generic_failure,null);} return;}
function fireUpdateAlertHeadlineWidgetScriptCode(){var delegate=new EMG.widgets.ui.delegates.input.UpdateAlertHeadlineWidgetDelegate();var result=FactivaWidgetRenderManager.getInstance().getData();if(fillAlertHeadlineWidgetDelegate(delegate,result,true)){var wIdHiddenInput=$get("wid");if(wIdHiddenInput){$get("mPopHeader").innerHTML=translate("displayCode");CommonToolkitScripts.setVisible($get("codeLoadingCntr"),false);CommonToolkitScripts.setVisible($get("codeUpdatingCntr"),true);CommonToolkitScripts.setVisible($get("codeCntr"),false);CommonToolkitScripts.setVisible($get("divBase"),false);var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.set_Y(100);modalPopupBehavior.show();EMG.widgets.services.WidgetDesignerManager.GetAlertHeadlineWidgetScriptCode(wIdHiddenInput.value,delegate,accessPointCode,interfaceLanguage,sa_from,getScriptCode_success,generic_failure,null);return;} showError(translate("noWidgetIdFound"));}}
function fillAlertHeadlineWidgetDelegate(delegate,result,fillWidgetId){if(result.Data!=null&&result.Data.Count>0){var ids=[];var exKeys=[];for(var i=0;i<result.Data.Count;i++){var _alert=result.Data.Alerts[i];if(_alert.Status.Code==0){ids[ids.length]=_alert.Id;exKeys[exKeys.length]=_alert.ExternalAccessToken;}} var wIdHiddenInput=$get("wid");if(wIdHiddenInput&&fillWidgetId){delegate.widgetId=wIdHiddenInput.value;} if(ids.length>0){delegate.assetIds=ids;delegate.externalHashKeys=exKeys;delegate.name=cStr($get("wName").value).trim();delegate.description="";delegate.maxResultsToReturn=$get("numHdlnes").selectedIndex;delegate.mainColor=validateColor($get("mainColor_input").value,"#999999");delegate.mainFontColor=validateColor($get("mainFontColor_input").value,"#FFFFFF");delegate.accentColor=validateColor($get("accentColor_input").value,"#F0F0F0");delegate.accentFontColor=validateColor($get("accentFontColor_input").value,"#000000");delegate.chartBarColor=validateColor($get("chartBarColor_input").value,"#DCDADA");delegate.chartRenderType=1;delegate.distributionType=getAudience();delegate.headlineDisplayType=($get("hdlnDspl_0").checked)?0:1;delegate.fontFamily=$get("fFmly").selectedIndex;delegate.fontSize=$get("fSize").selectedIndex;delegate.widgetTemplate=$get("selTemp").selectedIndex;delegate.discoveryTabs=Sys.Serialization.JavaScriptSerializer.deserialize($get("tabStates").value);if($get("proxyCredUserId")){delegate.authenticationScheme=getAuthScheme();delegate.proxyUserId=cStr($get("proxyCredUserId").value).trim();delegate.proxyEmailAddress=cStr($get("proxyCredEmailAddress").value).trim();delegate.proxyNamespace=cStr($get("proxyCredNamespace").value).trim();delegate.proxyPassword=cStr($get("proxyCredPassword").value).trim();} if($get("profileId")){var selectObj=$get("profileId");delegate.profileId=cInt(cStr(selectObj.options[selectObj.selectedIndex].value).trim());} if(delegate.name==null||delegate.name.length==0){showError(translate("nameIsNotProvided"));return false;} if(delegate.distributionType=="2"){switch(delegate.authenticationScheme){case"0":if(delegate.proxyUserId==null||delegate.proxyUserId.length==0){getProxyCredentialsPopup(translate("editUserID"));return false;} if(delegate.proxyPassword==null||delegate.proxyPassword.length==0){getProxyCredentialsPopup(translate("editPassword"));return false;} if(delegate.proxyNamespace==null||delegate.proxyNamespace.length==0){getProxyCredentialsPopup(translate("editNameSpace"));return false;} break;case"1":if(delegate.proxyEmailAddress==null||delegate.proxyEmailAddress.length==0){getProxyCredentialsPopup(translate("editEmailAddress"));return false;} if(delegate.proxyPassword==null||delegate.proxyPassword.length==0){getProxyCredentialsPopup(translate("editPassword"));return false;} break;}} return true;} else{showError(translate("noAlertsFound"));return false;}}}
function removeDesignerHandlersForAlertHeadlineWidget(){$removeHandler($get("wName"),"blur",updateAlertHeadlineWidgetPreview);$removeHandler($get("mainColor_input"),"blur",updateAlertHeadlineWidgetPreview);$removeHandler($get("mainFontColor_input"),"blur",updateAlertHeadlineWidgetPreview);$removeHandler($get("accentColor_input"),"blur",updateAlertHeadlineWidgetPreview);$removeHandler($get("accentFontColor_input"),"blur",updateAlertHeadlineWidgetPreview);$removeHandler($get("chartBarColor_input"),"blur",updateAlertHeadlineWidgetPreview);$removeHandler($get("fFmly"),"change",updateAlertHeadlineWidgetPreview);$removeHandler($get("fSize"),"change",updateAlertHeadlineWidgetPreview);$removeHandler($get("numHdlnes"),"change",updateAlertHeadlineWidgetPreview);$removeHandler($get("selTemp"),"change",updateTemplateColorsForAlertPreview);$removeHandler($get("hdlnDspl_0"),"click",updateAlertHeadlineWidgetPreview);$removeHandler($get("hdlnDspl_1"),"click",updateAlertHeadlineWidgetPreview);if($get("audience_0"))$removeHandler($get("audience_0"),"click",updateAlertHeadlineWidgetPreview);if($get("audience_1"))$removeHandler($get("audience_1"),"click",updateAlertHeadlineWidgetPreview);if($get("audience_2"))$removeHandler($get("audience_2"),"click",updateAlertHeadlineWidgetPreview);if($get("audience_3"))$removeHandler($get("audience_3"),"click",updateAlertHeadlineWidgetPreview);if($get("proxyCredUserId")){$removeHandler($get("authScheme_0"),"click",updateProxyCredAuthSchemeHandler);$removeHandler($get("authScheme_1"),"click",updateProxyCredAuthSchemeHandler);} if($get("http")&&$get("https")){$removeHandler($get("http"),'click',addSecurityToTextArea);$removeHandler($get("https"),'click',addSecurityToTextArea);}}
function initDesignerForAlertHeadlineWidget(){var wIdInput=$get("wid");var _wId=trim(cStr(wIdInput.value));var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.set_Y(100);modalPopupBehavior.show();$get("mPopHeader").innerHTML=translate("widgetDesigner");CommonToolkitScripts.setVisible($get("codeLoadingCntr"),true);CommonToolkitScripts.setVisible($get("codeUpdatingCntr"),false);CommonToolkitScripts.setVisible($get("codeCntr"),false);CommonToolkitScripts.setVisible($get("divBase"),false);CommonToolkitScripts.setVisible($get("wdgtAudienceCntrl"),true);if(_wId.length>0){CommonToolkitScripts.setVisible($get("wdgtCreateCntrl"),false);CommonToolkitScripts.setVisible($get("wdgtUpdateCntrl"),true);CommonToolkitScripts.setVisible($get("wdgtCodeGenCntrl"),true);EMG.widgets.services.WidgetDesignerManager.GetAlertHeadlineWidget(_wId,accessPointCode,interfaceLanguage,sa_from,initDesigner_success,generic_failure,null);return;} var alertIDs=new Array();var tAssetIds=$get("assetIds");if(tAssetIds){var ids=trim(cStr(tAssetIds.value));CommonToolkitScripts.setVisible($get("wdgtCreateCntrl"),true);CommonToolkitScripts.setVisible($get("wdgtUpdateCntrl"),false);CommonToolkitScripts.setVisible($get("wdgtCodeGenCntrl"),false);if(ids.length>0){alertIDs=ids.split(",");} if(alertIDs!=null&&alertIDs.length>0){EMG.widgets.services.WidgetDesignerManager.GetBaselineAlertHeadlineWidget(alertIDs,accessPointCode,interfaceLanguage,sa_from,initDesigner_success,generic_failure,null);return;}}}
function updateAlertHeadlineWidgetPreview(){if(FactivaWidgetRenderManager.getInstance().getData()!=null){var result=FactivaWidgetRenderManager.getInstance().getData();result.Definition.MainColor=$get("mainColor_input").value=validateColor($get("mainColor_input").value,"#4945899");result.Definition.MainFontColor=$get("mainFontColor_input").value=validateColor($get("mainFontColor_input").value,"#F7F7F7");result.Definition.AccentColor=$get("accentColor_input").value=validateColor($get("accentColor_input").value,"#B4B4CC");result.Definition.AccentFontColor=$get("accentFontColor_input").value=validateColor($get("accentFontColor_input").value,"#171717");result.Definition.ChartBarColor=$get("chartBarColor_input").value=validateColor($get("chartBarColor_input").value,"#DCDADA");if(result.Data!=null&&result.Data.Count>0){for(var i=0;i<result.Data.Count;i++){if(result.Data.Alerts[i].CompaniesChart!=null&&result.Data.Alerts[i].CompaniesChart.Chart!=null){result.Data.Alerts[i].CompaniesChart.Chart.chartUri=emg_baseChartingUrl+"?chartType=co&chartBarColor=%23"+result.Definition.ChartBarColor.substr(1);} if(result.Data.Alerts[i].IndustriesChart!=null&&result.Data.Alerts[i].IndustriesChart.Chart!=null){result.Data.Alerts[i].IndustriesChart.Chart.chartUri=emg_baseChartingUrl+"?chartType=in&chartBarColor=%23"+result.Definition.ChartBarColor.substr(1);} if(result.Data.Alerts[i].SubjectsChart!=null&&result.Data.Alerts[i].SubjectsChart.Chart!=null){result.Data.Alerts[i].SubjectsChart.Chart.chartUri=emg_baseChartingUrl+"?chartType=ns&chartBarColor=%23"+result.Definition.ChartBarColor.substr(1);} if(result.Data.Alerts[i].ExecutivesChart!=null&&result.Data.Alerts[i].ExecutivesChart.Chart!=null){result.Data.Alerts[i].ExecutivesChart.Chart.chartUri=emg_baseChartingUrl+"?chartType=ex&chartBarColor=%23"+result.Definition.ChartBarColor.substr(1);} if(result.Data.Alerts[i].RegionsChart!=null&&result.Data.Alerts[i].RegionsChart.Chart!=null){result.Data.Alerts[i].RegionsChart.Chart.chartUri=emg_baseChartingUrl+"?chartType=re&chartBarColor=%23"+result.Definition.ChartBarColor.substr(1);}}} var fontFamily=$get("fFmly");if(fontFamily){result.Definition.FontFamily=fontFamily.selectedIndex;} var fontSize=$get("fSize");if(fontSize){result.Definition.FontSize=fontSize.selectedIndex;} var numHeadlines=$get("numHdlnes");if(numHeadlines){result.Definition.NumOfHeadlines=numHeadlines.selectedIndex;} var widgetName=$get("wName");if(widgetName){result.Definition.Name=trim(cStr(widgetName.value));} var tabStates=$get("tabStates");if(tabStates){result.Definition.DiscoveryTabs=Sys.Serialization.JavaScriptSerializer.deserialize(trim(cStr(tabStates.value)));} var selTemp=$get("selTemp");if(selTemp){result.Definition.WidgetTemplate=selTemp.selectedIndex;} result.Definition.DistributionType=$get("audience_0").checked?0:($get("audience_1").checked?1:($get("audience_2")&&$get("audience_2").checked?2:3));result.Definition.DisplayType=($get("hdlnDspl_0")&&$get("hdlnDspl_0").checked)?0:1;FactivaWidgetRenderManager.getInstance().xBuildAlertWidget("previewContents",result,true);}}
function updateTemplateColorsForAlertPreview(){if(FactivaWidgetRenderManager.getInstance().getColorTemplates()!=null){var fontSize=$get("fSize");var fontFamily=$get("fFmly");var mainColor=$get("mainColor_input");var mainFontColor=$get("mainFontColor_input");var accentColor=$get("accentColor_input");var accentFontColor=$get("accentFontColor_input");var chartBarColor=$get("chartBarColor_input");var fontSizeRow=$get("fontSizeRow");var fontFamilyRow=$get("fontFamilyRow");var mainColorRow=$get("mainColorRow");var mainFontColorRow=$get("mainFontColorRow");var accentColorRow=$get("accentColorRow");var accentFontColorRow=$get("accentFontColorRow");var chartBarColorRow=$get("chartBarColorRow");var colorTemplates=FactivaWidgetRenderManager.getInstance().getColorTemplates();var index=$get("selTemp").selectedIndex;if(index!=0){var currentTemplate=colorTemplates[index];fontSizeRow.style.visibility="hidden";fontFamilyRow.style.visibility="hidden";mainColorRow.style.visibility="hidden";mainFontColorRow.style.visibility="hidden";accentColorRow.style.visibility="hidden";accentFontColorRow.style.visibility="hidden";chartBarColorRow.style.visibility="hidden";fontSize.selectedIndex=currentTemplate.fontSize;fontFamily.selectedIndex=currentTemplate.fontFamily;mainColor.value=currentTemplate.mainColor;mainFontColor.value=currentTemplate.mainFontColor;accentColor.value=currentTemplate.accentColor;accentFontColor.value=currentTemplate.accentFontColor;chartBarColor.value=currentTemplate.chartBarColor;$find("mainColor_input_behavior").setColor(currentTemplate.mainColor);$find("mainFontColor_input_behavior").setColor(currentTemplate.mainFontColor);$find("accentColor_input_behavior").setColor(currentTemplate.accentColor);$find("accentFontColor_input_behavior").setColor(currentTemplate.accentFontColor);$find("chartBarColor_input_behavior").setColor(currentTemplate.chartBarColor);} else{fontSizeRow.style.visibility="visible";fontFamilyRow.style.visibility="visible";mainColorRow.style.visibility="visible";mainFontColorRow.style.visibility="visible";accentColorRow.style.visibility="visible";accentFontColorRow.style.visibility="visible";chartBarColorRow.style.visibility="visible";} updateAlertHeadlineWidgetPreview();}}
function initDesignerSuccessForAlertHeadlineWidget(result,userContext,methodName){FactivaWidgetRenderManager.getInstance().setData(result);var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.hide();if(result!=null&&(result.ReturnCode==0||result.ReturnCode==NO_VALID_FOLDERS)&&result.Definition!=null){if($find("mainColor_input_behavior")){$find("mainColor_input_behavior").setColor(result.Definition.MainColor);$find("mainFontColor_input_behavior").setColor(result.Definition.MainFontColor);$find("accentColor_input_behavior").setColor(result.Definition.AccentColor);$find("accentFontColor_input_behavior").setColor(result.Definition.AccentFontColor);$find("chartBarColor_input_behavior").setColor(result.Definition.ChartBarColor);} var fontFamily=$get("fFmly");if(fontFamily){fontFamily.selectedIndex=result.Definition.FontFamily;} var fontSize=$get("fSize");if(fontSize){fontSize.selectedIndex=result.Definition.FontSize;} var fontSize=$get("numHdlnes");if(fontSize){fontSize.selectedIndex=result.Definition.NumOfHeadlines;} var widgetName=$get("wName");if(widgetName){widgetName.value=result.Definition.Name;} var headlines=$get("hdlnDspl_0");var headlinesWSnippets=$get("hdlnDspl_1");if(headlines&&headlinesWSnippets){$get("hdlnDspl_"+result.Definition.DisplayType).checked=true;} var selTemp=$get("selTemp");if(selTemp){selTemp.selectedIndex=result.Definition.WidgetTemplate;if(selTemp.selectedIndex!=0){$get("fontSizeRow").style.visibility="hidden";$get("fontFamilyRow").style.visibility="hidden";$get("mainColorRow").style.visibility="hidden";$get("mainFontColorRow").style.visibility="hidden";$get("accentColorRow").style.visibility="hidden";$get("accentFontColorRow").style.visibility="hidden";$get("chartBarColorRow").style.visibility="hidden";}} var tabStates=$get("tabStates");if(tabStates){tabStates.value=Sys.Serialization.JavaScriptSerializer.serialize(result.Definition.DiscoveryTabs);var tabBehavior=$find("wDesignerBehavior");tabBehavior.dispose();$("#wSortContainer").empty();$create(EMG.widgets.ui.ajax.controls.WidgetDesigner.WidgetDesignerBehavior,{"appendInsideControlID":"wSortContainer","axis":"y","discoveryTabs":tabStates.value,"id":"wDesignerBehavior"},{"widgetDesignerUpdate":updateAlertHeadlineWidgetPreview},null,$get("tabStates"));} var tForm=getBForm();var defaultAudience=$get("audience_0");var targetAudience=$get("audience_"+result.Definition.DistributionType);if(targetAudience){targetAudience.checked=true;} else if(defaultAudience){defaultAudience.checked=true;} if(result.Definition.AuthenticationCredentials!=null){if($get("proxyCredUserId")){if(result.Definition.AuthenticationCredentials.AuthenticationScheme!=null)$get("authScheme_"+result.Definition.AuthenticationCredentials.AuthenticationScheme).checked=true;if(result.Definition.AuthenticationCredentials.ProxyUserId!=null&&result.Definition.AuthenticationCredentials.ProxyUserId.length>0)$get("proxyCredUserId").value=result.Definition.AuthenticationCredentials.ProxyUserId;if(result.Definition.AuthenticationCredentials.ProxyEmailAddress!=null&&result.Definition.AuthenticationCredentials.ProxyEmailAddress.length>0)$get("proxyCredEmailAddress").value=result.Definition.AuthenticationCredentials.ProxyEmailAddress;if(result.Definition.AuthenticationCredentials.ProxyPassword!=null&&result.Definition.AuthenticationCredentials.ProxyPassword.length>0)$get("proxyCredPassword").value=result.Definition.AuthenticationCredentials.ProxyPassword;if(result.Definition.AuthenticationCredentials.ProxyNamespace!=null&&result.Definition.AuthenticationCredentials.ProxyNamespace.length>0)$get("proxyCredNamespace").value=result.Definition.AuthenticationCredentials.ProxyNamespace;updateProxyCredAuthScheme(true);} var profileIdSelectObj=$get("profileId");if(profileIdSelectObj&&result.Definition.AuthenticationCredentials.ProfileId!=null&&result.Definition.AuthenticationCredentials.ProfileId.length>0){for(var i=0;i<profileIdSelectObj.options.length;i++){if(profileIdSelectObj.options[i].value==result.Definition.AuthenticationCredentials.ProfileId){profileIdSelectObj.selectedIndex=i;break;}}}} FactivaWidgetRenderManager.getInstance().xBuildAlertWidget("previewContents",result,true);if(result.ReturnCode==0){FactivaWidgetRenderManager.getInstance().setInitialized(true);} if(emg_screenAction=="Publish"){okUpdate();}} else if(result!=null&&result.ReturnCode!=0){showFrameworkError(result);FactivaWidgetRenderManager.getInstance().xBuildAlertWidget("previewContents",result,true);return;} else{var widgetIdInput=$get("wid");if(widgetIdInput){widgetIdInput.value="";fireMyWidgets();} return;}}
function addDesignerHandlersForAutomaticWorkspaceWidget(){$addHandler($get("wName"),"blur",updateAutomaticWorkspaceWidgetPreview);$addHandler($get("mainColor_input"),"blur",updateAutomaticWorkspaceWidgetPreview);$addHandler($get("mainFontColor_input"),"blur",updateAutomaticWorkspaceWidgetPreview);$addHandler($get("accentColor_input"),"blur",updateAutomaticWorkspaceWidgetPreview);$addHandler($get("accentFontColor_input"),"blur",updateAutomaticWorkspaceWidgetPreview);$addHandler($get("fFmly"),"change",updateAutomaticWorkspaceWidgetPreview);$addHandler($get("fSize"),"change",updateAutomaticWorkspaceWidgetPreview);$addHandler($get("numHdlnes"),"change",updateAutomaticWorkspaceWidgetPreview);$addHandler($get("selTemp"),"change",updateTemplateColorsForWorkspacePreview);$addHandler($get("hdlnDspl_0"),"click",updateAutomaticWorkspaceWidgetPreview);$addHandler($get("hdlnDspl_1"),"click",updateAutomaticWorkspaceWidgetPreview);if($get("http")&&$get("https")){$addHandler($get("http"),'click',addSecurityToTextArea);$addHandler($get("https"),'click',addSecurityToTextArea);}}
function removeDesignerHandlersForAutomaticWorkspaceWidget(){$removeHandler($get("wName"),"blur",updateAutomaticWorkspaceWidgetPreview);$removeHandler($get("mainColor_input"),"blur",updateAutomaticWorkspaceWidgetPreview);$removeHandler($get("mainFontColor_input"),"blur",updateAutomaticWorkspaceWidgetPreview);$removeHandler($get("accentColor_input"),"blur",updateAutomaticWorkspaceWidgetPreview);$removeHandler($get("accentFontColor_input"),"blur",updateAutomaticWorkspaceWidgetPreview);$removeHandler($get("fFmly"),"change",updateAutomaticWorkspaceWidgetPreview);$removeHandler($get("fSize"),"change",updateAutomaticWorkspaceWidgetPreview);$removeHandler($get("numHdlnes"),"change",updateAutomaticWorkspaceWidgetPreview);$removeHandler($get("selTemp"),"change",updateTemplateColorsForWorkspacePreview);$removeHandler($get("hdlnDspl_0"),"click",updateAutomaticWorkspaceWidgetPreview);$removeHandler($get("hdlnDspl_1"),"click",updateAutomaticWorkspaceWidgetPreview);if($get("http")&&$get("https")){$removeHandler($get("http"),'click',addSecurityToTextArea);$removeHandler($get("https"),'click',addSecurityToTextArea);}}
function disableAutomaticWorkspaceDesignerControls(){$get("wName").disabled=true;}
function updateTemplateColorsForWorkspacePreview(){if(FactivaWidgetRenderManager.getInstance().getColorTemplates()!=null){var fontSize=$get("fSize");var fontFamily=$get("fFmly");var mainColor=$get("mainColor_input");var mainFontColor=$get("mainFontColor_input");var accentColor=$get("accentColor_input");var accentFontColor=$get("accentFontColor_input");var fontSizeRow=$get("fontSizeRow");var fontFamilyRow=$get("fontFamilyRow");var mainColorRow=$get("mainColorRow");var mainFontColorRow=$get("mainFontColorRow");var accentColorRow=$get("accentColorRow");var accentFontColorRow=$get("accentFontColorRow");var colorTemplates=FactivaWidgetRenderManager.getInstance().getColorTemplates();var index=$get("selTemp").selectedIndex;if(index!=0){var currentTemplate=colorTemplates[index];fontSizeRow.style.visibility="hidden";fontFamilyRow.style.visibility="hidden";mainColorRow.style.visibility="hidden";mainFontColorRow.style.visibility="hidden";accentColorRow.style.visibility="hidden";accentFontColorRow.style.visibility="hidden";fontSize.selectedIndex=currentTemplate.fontSize;fontFamily.selectedIndex=currentTemplate.fontFamily;mainColor.value=currentTemplate.mainColor;mainFontColor.value=currentTemplate.mainFontColor;accentColor.value=currentTemplate.accentColor;accentFontColor.value=currentTemplate.accentFontColor;$find("mainColor_input_behavior").setColor(currentTemplate.mainColor);$find("mainFontColor_input_behavior").setColor(currentTemplate.mainFontColor);$find("accentColor_input_behavior").setColor(currentTemplate.accentColor);$find("accentFontColor_input_behavior").setColor(currentTemplate.accentFontColor);} else{fontSizeRow.style.visibility="visible";fontFamilyRow.style.visibility="visible";mainColorRow.style.visibility="visible";mainFontColorRow.style.visibility="visible";accentColorRow.style.visibility="visible";accentFontColorRow.style.visibility="visible";} updateAutomaticWorkspaceWidgetPreview();}}
function initDesignerForAutomaticWorkspaceWidget(){var wIdInput=$get("wid");var _wId=trim(cStr(wIdInput.value));disableAutomaticWorkspaceDesignerControls();var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.set_Y(100);modalPopupBehavior.show();$get("mPopHeader").innerHTML=translate("widgetDesigner");CommonToolkitScripts.setVisible($get("codeLoadingCntr"),true);CommonToolkitScripts.setVisible($get("codeUpdatingCntr"),false);CommonToolkitScripts.setVisible($get("codeCntr"),false);CommonToolkitScripts.setVisible($get("divBase"),false);CommonToolkitScripts.setVisible($get("wdgtAudienceCntrl"),true);if(_wId.length>0){CommonToolkitScripts.setVisible($get("wdgtCreateCntrl"),false);CommonToolkitScripts.setVisible($get("wdgtUpdateCntrl"),true);CommonToolkitScripts.setVisible($get("wdgtCodeGenCntrl"),true);EMG.widgets.services.WidgetDesignerManager.GetAutomaticWorkspaceWidget(_wId,accessPointCode,interfaceLanguage,sa_from,initDesigner_success,generic_failure,null);return;} var assetIds=new Array();var tAssetIds=$get("assetIds");if(tAssetIds){var ids=trim(cStr(tAssetIds.value));CommonToolkitScripts.setVisible($get("wdgtCreateCntrl"),true);CommonToolkitScripts.setVisible($get("wdgtUpdateCntrl"),false);CommonToolkitScripts.setVisible($get("wdgtCodeGenCntrl"),false);if(ids.length>0){assetIds=ids.split(",");} if(assetIds!=null&&assetIds.length>0){EMG.widgets.services.WidgetDesignerManager.GetBaselineAutomaticWorkspaceWidget(assetIds,accessPointCode,interfaceLanguage,sa_from,initDesigner_success,generic_failure,null);return;}}}
function updateAutomaticWorkspaceWidgetPreview(){if(FactivaWidgetRenderManager.getInstance().getData()!=null){var result=FactivaWidgetRenderManager.getInstance().getData();result.Definition.MainColor=$get("mainColor_input").value=validateColor($get("mainColor_input").value,"#4945899");result.Definition.MainFontColor=$get("mainFontColor_input").value=validateColor($get("mainFontColor_input").value,"#F7F7F7");result.Definition.AccentColor=$get("accentColor_input").value=validateColor($get("accentColor_input").value,"#B4B4CC");result.Definition.AccentFontColor=$get("accentFontColor_input").value=validateColor($get("accentFontColor_input").value,"#171717");var fontFamily=$get("fFmly");if(fontFamily){result.Definition.FontFamily=fontFamily.selectedIndex;} var fontSize=$get("fSize");if(fontSize){result.Definition.FontSize=fontSize.selectedIndex;} var fontSize=$get("numHdlnes");if(fontSize){result.Definition.NumOfHeadlines=fontSize.selectedIndex+1;} var widgetName=$get("wName");if(widgetName){result.Definition.Name=trim(cStr(widgetName.value));} var selTemp=$get("selTemp");if(selTemp){result.Definition.WidgetTemplate=selTemp.selectedIndex;} result.Definition.DisplayType=($get("hdlnDspl_0")&&$get("hdlnDspl_0").checked)?0:1;FactivaWidgetRenderManager.getInstance().xBuildAutomaticWorkspaceWidget("previewContents",result,true);}}
function initDesignerSuccessForAutomaticWorkspaceWidget(result,userContext,methodName){FactivaWidgetRenderManager.getInstance().setData(result);var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.hide();if(result!=null&&(result.ReturnCode==0||result.ReturnCode==NO_VALID_FOLDERS)&&result.Definition!=null){if($find("mainColor_input_behavior")){$find("mainColor_input_behavior").setColor(result.Definition.MainColor);$find("mainFontColor_input_behavior").setColor(result.Definition.MainFontColor);$find("accentColor_input_behavior").setColor(result.Definition.AccentColor);$find("accentFontColor_input_behavior").setColor(result.Definition.AccentFontColor);} var fontFamily=$get("fFmly");if(fontFamily){fontFamily.selectedIndex=result.Definition.FontFamily;} var fontSize=$get("fSize");if(fontSize){fontSize.selectedIndex=result.Definition.FontSize;} var fontSize=$get("numHdlnes");if(fontSize){fontSize.selectedIndex=result.Definition.NumOfHeadlines-1;} var widgetName=$get("wName");if(widgetName){widgetName.value=result.Definition.Name;} var selTemp=$get("selTemp");if(selTemp){selTemp.selectedIndex=result.Definition.WidgetTemplate;if(selTemp.selectedIndex!=0){$get("fontSizeRow").style.visibility="hidden";$get("fontFamilyRow").style.visibility="hidden";$get("mainColorRow").style.visibility="hidden";$get("mainFontColorRow").style.visibility="hidden";$get("accentColorRow").style.visibility="hidden";$get("accentFontColorRow").style.visibility="hidden";}} var headlines=$get("hdlnDspl_0");var headlinesWSnippets=$get("hdlnDspl_1");if(headlines&&headlinesWSnippets){$get("hdlnDspl_"+result.Definition.DisplayType).checked=true;} FactivaWidgetRenderManager.getInstance().xBuildAutomaticWorkspaceWidget("previewContents",result,true);if(result.ReturnCode==0){FactivaWidgetRenderManager.getInstance().setInitialized(true);} if(emg_screenAction=="Publish"){okUpdate();}} else if(result!=null&&result.ReturnCode!=0){showFrameworkError(result);FactivaWidgetRenderManager.getInstance().xBuildAutomaticWorkspaceWidget("previewContents",result,true);return;} else{var widgetIdInput=$get("wid");if(widgetIdInput){widgetIdInput.value="";fireMyWidgets();return;}}}
function fillAutomaticWorkspaceWidgetDelegate(delegate,result,fillWidgetId){if(result.Data!=null&&result.Data.AutomaticWorkspaceInfo!=null){var wIdHiddenInput=$get("wid");if(wIdHiddenInput&&fillWidgetId){delegate.widgetId=wIdHiddenInput.value;} var temp=new Array();temp[temp.length]=result.Data.AutomaticWorkspaceInfo.Id;delegate.assetIds=temp;delegate.name="";delegate.description="";delegate.maxResultsToReturn=$get("numHdlnes").selectedIndex+1;delegate.mainColor=validateColor($get("mainColor_input").value,"#999999");delegate.mainFontColor=validateColor($get("mainFontColor_input").value,"#FFFFFF");delegate.accentColor=validateColor($get("accentColor_input").value,"#F0F0F0");delegate.accentFontColor=validateColor($get("accentFontColor_input").value,"#000000");delegate.headlineDisplayType=($get("hdlnDspl_0").checked)?0:1;delegate.fontFamily=$get("fFmly").selectedIndex;delegate.fontSize=$get("fSize").selectedIndex;delegate.widgetTemplate=$get("selTemp").selectedIndex;return true;} return false;}
function fireCreateAutomaticWorkspaceHeadlineWidget(){console.log("fireCreateAutomaticWorkspaceHeadlineWidget");var delegate=new EMG.widgets.ui.delegates.input.CreateAutomaticWorkspaceWidgetDelegate();var result=FactivaWidgetRenderManager.getInstance().getData();console.log(result);if(fillAutomaticWorkspaceWidgetDelegate(delegate,result)){$get("mPopHeader").innerHTML=translate("saveWidgetDesignNow");CommonToolkitScripts.setVisible($get("codeLoadingCntr"),false);CommonToolkitScripts.setVisible($get("codeUpdatingCntr"),true);CommonToolkitScripts.setVisible($get("codeCntr"),false);CommonToolkitScripts.setVisible($get("divBase"),false);var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.set_Y(100);modalPopupBehavior.show();EMG.widgets.services.WidgetDesignerManager.CreateAutomaticWorkspaceWidget(delegate,accessPointCode,interfaceLanguage,sa_from,createWidget_success,generic_failure,null);} return;}
function fireUpdateAutomaticWorkspaceWidgetAndGetScriptCode(){var delegate=new EMG.widgets.ui.delegates.input.UpdateAutomaticWorkspaceWidgetDelegate();var result=FactivaWidgetRenderManager.getInstance().getData();if(fillAutomaticWorkspaceWidgetDelegate(delegate,result,true)){var wIdHiddenInput=$get("wid");if(wIdHiddenInput){$get("mPopHeader").innerHTML=translate("displayCode");CommonToolkitScripts.setVisible($get("codeLoadingCntr"),false);CommonToolkitScripts.setVisible($get("codeUpdatingCntr"),true);CommonToolkitScripts.setVisible($get("codeCntr"),false);CommonToolkitScripts.setVisible($get("divBase"),false);var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.set_Y(100);modalPopupBehavior.show();EMG.widgets.services.WidgetDesignerManager.GetAutomaticWorkspaceWidgetScriptCode(wIdHiddenInput.value,delegate,accessPointCode,interfaceLanguage,sa_from,getScriptCode_success,generic_failure,null);return;} showError(translate("noWidgetIdFound"));}}
function fireUpdateAutomaticWorkspaceHeadlineWidget(){console.log("fireUpdateAutomaticWorkspaceHeadlineWidget");var delegate=new EMG.widgets.ui.delegates.input.UpdateAutomaticWorkspaceWidgetDelegate();var result=FactivaWidgetRenderManager.getInstance().getData();console.log(result);if(fillAutomaticWorkspaceWidgetDelegate(delegate,result,true)){$get("mPopHeader").innerHTML=translate("saveWidgetDesignNow");CommonToolkitScripts.setVisible($get("codeLoadingCntr"),false);CommonToolkitScripts.setVisible($get("codeUpdatingCntr"),true);CommonToolkitScripts.setVisible($get("codeCntr"),false);CommonToolkitScripts.setVisible($get("divBase"),false);var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.set_Y(100);modalPopupBehavior.show();EMG.widgets.services.WidgetDesignerManager.UpdateAutomaticWorkspaceWidget(delegate,accessPointCode,interfaceLanguage,sa_from,updateWidget_success,generic_failure,null);} return;}
function addDesignerHandlersForManualNewsletterWorkspaceWidget(){$addHandler($get("wName"),"blur",updateManualNewsletterWorkspaceWidgetPreview);$addHandler($get("mainColor_input"),"blur",updateManualNewsletterWorkspaceWidgetPreview);$addHandler($get("mainFontColor_input"),"blur",updateManualNewsletterWorkspaceWidgetPreview);$addHandler($get("accentColor_input"),"blur",updateManualNewsletterWorkspaceWidgetPreview);$addHandler($get("accentFontColor_input"),"blur",updateManualNewsletterWorkspaceWidgetPreview);$addHandler($get("fFmly"),"change",updateManualNewsletterWorkspaceWidgetPreview);$addHandler($get("fSize"),"change",updateManualNewsletterWorkspaceWidgetPreview);$addHandler($get("numHdlnes"),"change",updateManualNewsletterWorkspaceWidgetPreview);$addHandler($get("selTemp"),"change",updateTemplateColorsForNewsletterPreview);$addHandler($get("hdlnDspl_0"),"click",updateManualNewsletterWorkspaceWidgetPreview);$addHandler($get("hdlnDspl_1"),"click",updateManualNewsletterWorkspaceWidgetPreview);if($get("http")&&$get("https")){$addHandler($get("http"),'click',addSecurityToTextArea);$addHandler($get("https"),'click',addSecurityToTextArea);}}
function removeDesignerHandlersForManualNewsletterWorkspaceWidget(){$removeHandler($get("wName"),"blur",updateManualNewsletterWorkspaceWidgetPreview);$removeHandler($get("mainColor_input"),"blur",updateManualNewsletterWorkspaceWidgetPreview);$removeHandler($get("mainFontColor_input"),"blur",updateManualNewsletterWorkspaceWidgetPreview);$removeHandler($get("accentColor_input"),"blur",updateManualNewsletterWorkspaceWidgetPreview);$removeHandler($get("accentFontColor_input"),"blur",updateManualNewsletterWorkspaceWidgetPreview);$removeHandler($get("fFmly"),"change",updateManualNewsletterWorkspaceWidgetPreview);$removeHandler($get("fSize"),"change",updateManualNewsletterWorkspaceWidgetPreview);$removeHandler($get("numHdlnes"),"change",updateManualNewsletterWorkspaceWidgetPreview);$removeHandler($get("selTemp"),"change",updateTemplateColorsForNewsletterPreview);$removeHandler($get("hdlnDspl_0"),"click",updateManualNewsletterWorkspaceWidgetPreview);$removeHandler($get("hdlnDspl_1"),"click",updateManualNewsletterWorkspaceWidgetPreview);if($get("http")&&$get("https")){$removeHandler($get("http"),'click',addSecurityToTextArea);$removeHandler($get("https"),'click',addSecurityToTextArea);}}
function disableManualNewsletterWorkspaceDesignerControls(){$get("wName").disabled=true;}
function updateTemplateColorsForNewsletterPreview(){if(FactivaWidgetRenderManager.getInstance().getColorTemplates()!=null){var fontSize=$get("fSize");var fontFamily=$get("fFmly");var mainColor=$get("mainColor_input");var mainFontColor=$get("mainFontColor_input");var accentColor=$get("accentColor_input");var accentFontColor=$get("accentFontColor_input");var fontSizeRow=$get("fontSizeRow");var fontFamilyRow=$get("fontFamilyRow");var mainColorRow=$get("mainColorRow");var mainFontColorRow=$get("mainFontColorRow");var accentColorRow=$get("accentColorRow");var accentFontColorRow=$get("accentFontColorRow");var colorTemplates=FactivaWidgetRenderManager.getInstance().getColorTemplates();var index=$get("selTemp").selectedIndex;if(index!=0){var currentTemplate=colorTemplates[index];fontSizeRow.style.visibility="hidden";fontFamilyRow.style.visibility="hidden";mainColorRow.style.visibility="hidden";mainFontColorRow.style.visibility="hidden";accentColorRow.style.visibility="hidden";accentFontColorRow.style.visibility="hidden";fontSize.selectedIndex=currentTemplate.fontSize;fontFamily.selectedIndex=currentTemplate.fontFamily;mainColor.value=currentTemplate.mainColor;mainFontColor.value=currentTemplate.mainFontColor;accentColor.value=currentTemplate.accentColor;accentFontColor.value=currentTemplate.accentFontColor;$find("mainColor_input_behavior").setColor(currentTemplate.mainColor);$find("mainFontColor_input_behavior").setColor(currentTemplate.mainFontColor);$find("accentColor_input_behavior").setColor(currentTemplate.accentColor);$find("accentFontColor_input_behavior").setColor(currentTemplate.accentFontColor);} else{fontSizeRow.style.visibility="visible";fontFamilyRow.style.visibility="visible";mainColorRow.style.visibility="visible";mainFontColorRow.style.visibility="visible";accentColorRow.style.visibility="visible";accentFontColorRow.style.visibility="visible";} updateManualNewsletterWorkspaceWidgetPreview();}}
function initDesignerForManualNewsletterWorkspaceWidget(){var wIdInput=$get("wid");var _wId=trim(cStr(wIdInput.value));disableManualNewsletterWorkspaceDesignerControls();var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.set_Y(100);modalPopupBehavior.show();$get("mPopHeader").innerHTML=translate("widgetDesigner");CommonToolkitScripts.setVisible($get("codeLoadingCntr"),true);CommonToolkitScripts.setVisible($get("codeUpdatingCntr"),false);CommonToolkitScripts.setVisible($get("codeCntr"),false);CommonToolkitScripts.setVisible($get("divBase"),false);CommonToolkitScripts.setVisible($get("wdgtAudienceCntrl"),true);if(_wId.length>0){CommonToolkitScripts.setVisible($get("wdgtCreateCntrl"),false);CommonToolkitScripts.setVisible($get("wdgtUpdateCntrl"),true);CommonToolkitScripts.setVisible($get("wdgtCodeGenCntrl"),true);EMG.widgets.services.WidgetDesignerManager.GetManualNewsletterWorkspaceWidget(_wId,accessPointCode,interfaceLanguage,sa_from,initDesigner_success,generic_failure,null);return;} var assetIds=new Array();var tAssetIds=$get("assetIds");if(tAssetIds){var ids=trim(cStr(tAssetIds.value));CommonToolkitScripts.setVisible($get("wdgtCreateCntrl"),true);CommonToolkitScripts.setVisible($get("wdgtUpdateCntrl"),false);CommonToolkitScripts.setVisible($get("wdgtCodeGenCntrl"),false);if(ids.length>0){assetIds=ids.split(",");} if(assetIds!=null&&assetIds.length>0){EMG.widgets.services.WidgetDesignerManager.GetBaselineManualNewsletterWorkspaceWidget(assetIds,accessPointCode,interfaceLanguage,sa_from,initDesigner_success,generic_failure,null);return;}}}
function updateManualNewsletterWorkspaceWidgetPreview(){if(FactivaWidgetRenderManager.getInstance().getData()!=null){var result=FactivaWidgetRenderManager.getInstance().getData();result.Definition.MainColor=$get("mainColor_input").value=validateColor($get("mainColor_input").value,"#4945899");result.Definition.MainFontColor=$get("mainFontColor_input").value=validateColor($get("mainFontColor_input").value,"#F7F7F7");result.Definition.AccentColor=$get("accentColor_input").value=validateColor($get("accentColor_input").value,"#B4B4CC");result.Definition.AccentFontColor=$get("accentFontColor_input").value=validateColor($get("accentFontColor_input").value,"#171717");var fontFamily=$get("fFmly");if(fontFamily){result.Definition.FontFamily=fontFamily.selectedIndex;} var fontSize=$get("fSize");if(fontSize){result.Definition.FontSize=fontSize.selectedIndex;} var headlinesOnly=$get("hdlnDspl_0");if(headlinesOnly){result.Definition.DisplayType=(headlinesOnly&&headlinesOnly.checked)?0:1;} var fontSize=$get("numHdlnes");if(fontSize){result.Definition.NumItemsPerSection=fontSize.selectedIndex+1;} var widgetName=$get("wName");if(widgetName){result.Definition.Name=trim(cStr(widgetName.value));} var selTemp=$get("selTemp");if(selTemp){result.Definition.WidgetTemplate=selTemp.selectedIndex;} FactivaWidgetRenderManager.getInstance().xBuildManualNewsletterWorkspaceWidget("previewContents",result,true);}}
function initDesignerSuccessForManualNewsletterWorkspaceWidget(result,userContext,methodName){console.log("initDesignerSuccessForManualNewsletterWorkspaceWidget");console.log("result:"+result);FactivaWidgetRenderManager.getInstance().setData(result);var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.hide();if(result!=null&&(result.ReturnCode==0||result.ReturnCode==NO_VALID_FOLDERS)&&result.Definition!=null){if($find("mainColor_input_behavior")){$find("mainColor_input_behavior").setColor(result.Definition.MainColor);$find("mainFontColor_input_behavior").setColor(result.Definition.MainFontColor);$find("accentColor_input_behavior").setColor(result.Definition.AccentColor);$find("accentFontColor_input_behavior").setColor(result.Definition.AccentFontColor);} var fontFamily=$get("fFmly");if(fontFamily){fontFamily.selectedIndex=result.Definition.FontFamily;} var fontSize=$get("fSize");if(fontSize){fontSize.selectedIndex=result.Definition.FontSize;} var headlines=$get("hdlnDspl_0");var headlinesWSnippets=$get("hdlnDspl_1");if(headlines&&headlinesWSnippets){$get("hdlnDspl_"+result.Definition.DisplayType).checked=true;} var fontSize=$get("numHdlnes");if(fontSize){fontSize.selectedIndex=result.Definition.NumItemsPerSection-1;} var widgetName=$get("wName");if(widgetName){widgetName.value=result.Definition.Name;} var selTemp=$get("selTemp");if(selTemp){selTemp.selectedIndex=result.Definition.WidgetTemplate;if(selTemp.selectedIndex!=0){$get("fontSizeRow").style.visibility="hidden";$get("fontFamilyRow").style.visibility="hidden";$get("mainColorRow").style.visibility="hidden";$get("mainFontColorRow").style.visibility="hidden";$get("accentColorRow").style.visibility="hidden";$get("accentFontColorRow").style.visibility="hidden";}} FactivaWidgetRenderManager.getInstance().xBuildManualNewsletterWorkspaceWidget("previewContents",result,true);if(result.ReturnCode==0){FactivaWidgetRenderManager.getInstance().setInitialized(true);} if(emg_screenAction=="Publish"){okUpdate();}} else if(result!=null&&result.ReturnCode!=0){showFrameworkError(result);FactivaWidgetRenderManager.getInstance().xBuildManualNewsletterWorkspaceWidget("previewContents",result,true);return;} else{var widgetIdInput=$get("wid");if(widgetIdInput){widgetIdInput.value="";fireMyWidgets();return;}}}
function fillManualNewsletterWorkspaceWidgetDelegate(delegate,result,fillWidgetId){if(result.Data!=null&&result.Data.ManualNewsletterWorkspaceInfo!=null){var wIdHiddenInput=$get("wid");if(wIdHiddenInput&&fillWidgetId){delegate.widgetId=wIdHiddenInput.value;} var temp=new Array();temp[temp.length]=result.Data.ManualNewsletterWorkspaceInfo.Id;delegate.assetIds=temp;delegate.name="";delegate.description="";delegate.maxResultsToReturn=$get("numHdlnes").selectedIndex+1;delegate.mainColor=validateColor($get("mainColor_input").value,"#999999");delegate.mainFontColor=validateColor($get("mainFontColor_input").value,"#FFFFFF");delegate.accentColor=validateColor($get("accentColor_input").value,"#F0F0F0");delegate.accentFontColor=validateColor($get("accentFontColor_input").value,"#000000");delegate.headlineDisplayType=($get("hdlnDspl_0").checked)?0:1;delegate.fontFamily=$get("fFmly").selectedIndex;delegate.fontSize=$get("fSize").selectedIndex;delegate.widgetTemplate=$get("selTemp").selectedIndex;return true;} return false;}
function fireUpdateManualNewsletterWorkspaceWidgetAndGetScriptCode(){var delegate=new EMG.widgets.ui.delegates.input.UpdateManualNewsletterWorkspaceWidgetDelegate();var result=FactivaWidgetRenderManager.getInstance().getData();if(fillManualNewsletterWorkspaceWidgetDelegate(delegate,result,true)){var wIdHiddenInput=$get("wid");if(wIdHiddenInput){$get("mPopHeader").innerHTML=translate("displayCode");CommonToolkitScripts.setVisible($get("codeLoadingCntr"),false);CommonToolkitScripts.setVisible($get("codeUpdatingCntr"),true);CommonToolkitScripts.setVisible($get("codeCntr"),false);CommonToolkitScripts.setVisible($get("divBase"),false);var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.set_Y(100);modalPopupBehavior.show();EMG.widgets.services.WidgetDesignerManager.GetManualNewsletterWorkspaceWidgetScriptCode(wIdHiddenInput.value,delegate,accessPointCode,interfaceLanguage,sa_from,getScriptCode_success,generic_failure,null);return;} showError(translate("noWidgetIdFound"));}}
function fireCreateManualNewsletterWorkspaceHeadlineWidget(){console.log("fireCreateManualNewsletterWorkspaceHeadlineWidget");var delegate=new EMG.widgets.ui.delegates.input.CreateManaualNewsletterWorkspaceWidgetDelegate();var result=FactivaWidgetRenderManager.getInstance().getData();console.log("result:"+result);if(fillManualNewsletterWorkspaceWidgetDelegate(delegate,result)){$get("mPopHeader").innerHTML=translate("saveWidgetDesignNow");CommonToolkitScripts.setVisible($get("codeLoadingCntr"),false);CommonToolkitScripts.setVisible($get("codeUpdatingCntr"),true);CommonToolkitScripts.setVisible($get("codeCntr"),false);CommonToolkitScripts.setVisible($get("divBase"),false);var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.set_Y(100);modalPopupBehavior.show();EMG.widgets.services.WidgetDesignerManager.CreateManualNewsletterWorkspaceWidget(delegate,accessPointCode,interfaceLanguage,sa_from,createWidget_success,generic_failure,null);} return;}
function fireUpdateManualNewsletterWorkspaceHeadlineWidget(){console.log("fireUpdateManualNewsletterWorkspaceHeadlineWidget");var delegate=new EMG.widgets.ui.delegates.input.UpdateManualNewsletterWorkspaceWidgetDelegate();var result=FactivaWidgetRenderManager.getInstance().getData();console.log(result);if(fillManualNewsletterWorkspaceWidgetDelegate(delegate,result,true)){$get("mPopHeader").innerHTML=translate("saveWidgetDesignNow");CommonToolkitScripts.setVisible($get("codeLoadingCntr"),false);CommonToolkitScripts.setVisible($get("codeUpdatingCntr"),true);CommonToolkitScripts.setVisible($get("codeCntr"),false);CommonToolkitScripts.setVisible($get("divBase"),false);var modalPopupBehavior=$find('programmaticModalPopupBehavior');modalPopupBehavior.set_Y(100);modalPopupBehavior.show();EMG.widgets.services.WidgetDesignerManager.UpdateManualNewsletterWorkspaceWidget(delegate,accessPointCode,interfaceLanguage,sa_from,updateWidget_success,generic_failure,null);} return;}