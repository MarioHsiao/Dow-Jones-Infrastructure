@model DowJones.Web.Mvc.UI.Components.Article.ArticleModel2

@ClientPlugin dj_Article2

@ScriptResource RelativeResourceName=Article2.js

@ClientTemplate RelativeResourceName=ClientTemplates.success.html, TemplateId=success
@ClientTemplate RelativeResourceName=ClientTemplates.logo.html, TemplateId=logo
@ClientTemplate RelativeResourceName=ClientTemplates.body.html, TemplateId=body
@ClientTemplate RelativeResourceName=ClientTemplates.paragraph.html, TemplateId=paragraph
@ClientTemplate RelativeResourceName=ClientTemplates.meta.html, TemplateId=meta
@ClientTemplate RelativeResourceName=ClientTemplates.noData.html, TemplateId=noData

@{ CssClass = "dj_Article"; }

@*<div class="dj_article-container dj_article_display_@(Model.ArticleDisplayOptions.ToString())" data-ref="@Model.ArticleRef.ToJson().EscapeForHtml()">
        <div class="dj_article_meta">
            <div class="meta">

                @if (!Model.ArticleDataSet.Credit.IsNullOrEmpty())
                {
                    if (showIndexing)
                    {
                    <div class="dj_article_index">CR</div>
                    }
                        
                    <div class="dj_article_cr dj_article_section">
                        @foreach (var renderItem in Model.ArticleDataSet.Credit)
                        {
                            <span class="credit">@renderItem.ItemText</span><span class="dj_article_comma">,
                            </span> 
                        }
                    </div>
                }

                <div class="dj_meta_group">
                    @if (showIndexing)
                    {
                        <div class="dj_article_index">PD</div>
                    }

                    <div class="date-stamp dj_article_pd dj_article_section">
                        @if (!string.IsNullOrEmpty(Model.ArticleDataSet.PublicationTime))
                        {
                            @(string.Format("{0},", Model.ArticleDataSet.PublicationTime))
                        }
                        @if (!string.IsNullOrEmpty(Model.ArticleDataSet.PublicationDate))
                        {
                            @(string.Format("{0}", Model.ArticleDataSet.PublicationDate))
                        }<span class="dj_article_comma">, </span>
                    </div>

                    @if (Model.ArticleDataSet.WordCount > 0 && Model.ArticleDataSet.Html.IsNullOrEmpty())
                    {
                        if (showIndexing)
                        {
                        <div class="dj_article_index">WC</div>
                        }
                        <div class="dj_article_wc dj_article_section">
                            @(string.Format("{0} {1}", Model.ArticleDataSet.WordCount, DJ.Token("words")))<span
                                class="dj_article_comma">, </span>
                        </div>
                    }
                    @if (!string.IsNullOrEmpty(Model.ArticleDataSet.Language))
                    {
                        if (showIndexing)
                        {
                        <div class="dj_article_index">LA</div>
                        }
                        <div class="dj_article_la dj_article_section">
                            @Model.ArticleDataSet.Language<span class="dj_article_comma">, </span>
                        </div>
                    }
                    @if (!Model.ArticleDataSet.Source.IsNullOrEmpty())
                    {
                        if (showIndexing)
                        {
                        <div class="dj_article_index">SC</div>
                        }
                        <div class="dj_article_sc dj_article_section">
                            @foreach (var renderItem in Model.ArticleDataSet.Source)
                            {
                                @renderItem.ItemEntityData.Code
                            }<span class="dj_article_comma">, </span>
                        </div>
                    }
                    @if (!Model.ArticleDataSet.Pages.IsNullOrEmpty())
                    {
                        if (showIndexing)
                        {
                        <div class="dj_article_index">PG</div>
                        }
                        <div class="dj_article_pg dj_article_section">
                            @foreach (var page in Model.ArticleDataSet.Pages)
                            {
                                @page
                            }<span class="dj_article_comma">,</span>
                        </div>
                    }
                </div>

                @if (!Model.ArticleDataSet.Copyright.IsNullOrEmpty())
                {
                    if (showIndexing)
                    {
                    <div class="dj_article_index">CY</div>
                    }
                    <div class="copyright dj_article_cy dj_article_section">
                        @foreach (var renderItem in Model.ArticleDataSet.Copyright.Where(renderItem => renderItem.ItemMarkUp == MarkUpType.Plain))
                        {
                            @renderItem.ItemText
                        }
                    </div>
                }
            </div>

            @if (Model.ShowPostProcessing)
            {
                if (!Model.PostProcessingOptions.IsNullOrEmpty())
                {
                    var tList = Model.PostProcessingOptions.ToList();
                    if (Model.ArticleDataSet.SubType.IsNullOrEmpty() ||
                             Model.ArticleDataSet.SubType.ToLower() != "nlapressclip")
                    {
                        tList.RemoveAll(x => x == PostProcessingOptions.PressClips);
                    }
                            
                <ul class="dj_PostProcessing actions clearfix">
                    @foreach (var item in tList)
                    {
                        <li class="@(item.ToString().ToLower()) action" data-ref="@(item.ToString().ToLower())">
                            <i class="dj_icon dj_icon-@(item.ToString().ToLower())"></i><span data-workflow="@(item.ToString().ToLower())">@(DJ.Token(DJ.GetAssignedAttribute<PostProcessingOptions>(item.ToString())))</span>
                        </li>
                    }
                </ul>
                }
                        
@*Build social buttons/ speakers/ translation*@
@*
                if (Model.HasSocialNetworks)
                {
                @(CreateChildControl<SocialButtons.SocialButtonsComponent>(Model.SocialButtons))
                }

                if (Model.HasTranslator)
                {
                <div id="articleTranslateControlsContainer">
                    @(CreateChildControl<ArticleTranslator.ArticleTranslatorComponent>(Model.Translator))
                </div>
                }    
@*Ends Build social buttons and speakers/ translation*@
@*            }
        </div>        
            
@*Start of embeded Html Section*@                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
@*            if (!Model.ArticleDataSet.Html.IsNullOrEmpty())
            {
        <div class="dj_rawContent">
            @foreach (var renderItem in Model.ArticleDataSet.Html.Where(renderItem => renderItem.ItemMarkUp == MarkUpType.Html))
            {
                @Html.Raw(renderItem.ItemText)
            }
        </div>
            }  
@*End of embeded Html Section*@                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        

                       
@*Start body Section*@ 
@*        <div class="dj_article_article_body">
            @if (!Model.ArticleDataSet.Correction.IsNullOrEmpty())
            {
                foreach (KeyValuePair<string, List<RenderItem>> kvc in Model.ArticleDataSet.Correction.SelectMany(dci => dci))
                {
                @(kvc.Key.Equals("pre") ? CreateChildControl<ParagraphComponent>(Model.GetParagraphModel(kvc.Value, "pre", "dj_article_paragraph"))
                                                    : CreateChildControl<ParagraphComponent>(Model.GetParagraphModel(kvc.Value, "p", "dj_article_paragraph")))
                }
            }
            @if (!Model.ArticleDataSet.LeadParagraph.IsNullOrEmpty())
            {
                if (showIndexing)
                {
                <div class="dj_article_index">LP</div>
                }                    
                <div class="dj_article_lp dj_article_section">
                    @if (!Model.ArticleDataSet.LeadParagraph.IsNullOrEmpty())
                    {
                        foreach (var kvc in Model.ArticleDataSet.LeadParagraph.SelectMany(dci => dci))
                        {
                        @(kvc.Key.Equals("pre") ? CreateChildControl<ParagraphComponent>(Model.GetParagraphModel(kvc.Value, "pre", "dj_article_paragraph"))
                                               : CreateChildControl<ParagraphComponent>(Model.GetParagraphModel(kvc.Value, "p", "dj_article_paragraph")))
                        }
                    }
                </div>
            }
            @if (!Model.ArticleDataSet.TailParagraphs.IsNullOrEmpty() && Model.ArticleDisplayOptions != DisplayOptions.Headline)
            {
                if (showIndexing)
                {
                <div class="dj_article_index">TD</div>
                }
                <div class="dj_article_td dj_article_section">
                    @foreach (var kvc in Model.ArticleDataSet.TailParagraphs.SelectMany(dci => dci))
                    {
                        @(kvc.Key.Equals("pre") ? CreateChildControl<ParagraphComponent>(Model.GetParagraphModel(kvc.Value, "pre", "dj_article_paragraph"))
                                           : CreateChildControl<ParagraphComponent>(Model.GetParagraphModel(kvc.Value, "p", "dj_article_paragraph")))
                    }
                </div>
            }
           
@* Tail Fields *@
@*            @if (Model.ArticleDisplayOptions != DisplayOptions.Headline)
            {
                if (!Model.ArticleDataSet.Contact.IsNullOrEmpty())
                {
                    if (showIndexing)
                    {
                <div class="dj_article_index">CT</div>
                    }
                
                <div class="dj_article_ct dj_article_section">
                    @(CreateChildControl<ParagraphComponent>(Model.GetParagraphModel(Model.ArticleDataSet.Contact, "p", "dj_article_paragraph")))
                </div>
                }

                if (!Model.ArticleDataSet.Notes.IsNullOrEmpty() && Model.ArticleDisplayOptions != DisplayOptions.Headline)
                {
                    if (showIndexing)
                    {
                <div class="dj_article_index">RF</div>
                    }
                
                <div class="dj_article_rf dj_article_section">
                    @foreach (var kvc in Model.ArticleDataSet.Notes.SelectMany(dci => dci))
                    {
                        @(kvc.Key.Equals("pre") ? CreateChildControl<ParagraphComponent>(Model.GetParagraphModel(kvc.Value, "pre", "dj_article_paragraph"))
                                                        : CreateChildControl<ParagraphComponent>(Model.GetParagraphModel(kvc.Value, "p", "dj_article_paragraph")))
                    }
                </div>
                }

                if (!Model.ArticleDataSet.ArtWorks.IsNullOrEmpty())
                {
                    if (showIndexing)
                    {
                <div class="dj_article_index">ART</div>
                    }
                <div class="dj_article_art dj_article_section">
                    @(CreateChildControl<ParagraphComponent>(Model.GetParagraphModel(Model.ArticleDataSet.ArtWorks, "p", "dj_article_paragraph")))
                </div>
                }
            }
            @if (!Model.ArticleDataSet.IndexingCodeSets.IsNullOrEmpty() && showIndexing)
            {
                foreach (var set in Model.ArticleDataSet.IndexingCodeSets)
                {
                    if (showIndexing)
                    {
                <div class="dj_article_index">@set.Key.ToUpper()</div>
                    }
                    
                <div class="dj_article_@(set.Key.ToLower()) dj_article_section">
                    <p class="dj_article_paragraph">
                        @foreach (var code in set.Value)
                        {
                            @(string.Format("{0} : {1} {2} ", code.Key, code.Value, code.Equals(set.Value.Last()) ? string.Empty : "|"))
                        }
                    </p>
                </div>
                }
            }
            @if (!Model.ArticleDataSet.Ipcs.IsNullOrEmpty() && showIndexing)
            {
                if (showIndexing)
                {
                <div class="dj_article_index">IPC</div>
                }
                <div class="dj_article_ipc dj_article_section">
                    <p class="dj_article_paragraph">
                        @Model.ArticleDataSet.Ipcs.ToArray().Join(" | ")
                    </p>
                </div>
            }
            @if (!Model.ArticleDataSet.Ipds.IsNullOrEmpty() && showIndexing)
            {
                if (showIndexing)
                {
                <div class="dj_article_index">IPD</div>
                }
                <div class="dj_article_ipd dj_article_section">
                    <p class="dj_article_paragraph">
                        @Model.ArticleDataSet.Ipds.ToArray().Join(" | ")
                    </p>
                </div>
            }
            @if (!string.IsNullOrEmpty(Model.ArticleDataSet.PublisherName))
            {
                if (showIndexing)
                {
                <div class="dj_article_index">PUB</div>
                }                    
                <div class="dj_article_pub dj_article_section">
                    <p class="dj_article_paragraph">
                        @string.Format("{0} ", Model.ArticleDataSet.PublisherName)
                    </p>
                </div>
            }
            @if (Model.ArticleDataSet.AccessionNo != null)
            {
                if (showIndexing)
                {
                <div class="dj_article_index">AN</div>
                }
                <div class="dj_article_an dj_article_section">
                    <p class="dj_article_paragraph">
                        @Html.DJ().Token("document")&nbsp;@Model.ArticleDataSet.AccessionNo
                    </p>
                </div>
            }
            @if (Model.ArticleDataSet.ContentCategory == Ajax.ContentCategory.Picture)
            {
                <div class="dj_article_clear"></div>
            }
        </div>
@*End body Section*@

@*</div>*@

